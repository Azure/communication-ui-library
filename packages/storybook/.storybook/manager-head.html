<meta name="title" content="Azure Communication Services UI Library">
<meta name="description"
  content="Azure Communication Services UI Library makes it easy for you to build modern communications user experiences using Azure Communication Services. It gives you a library of production-ready UI components that you can drop into your applications.">

<meta property="og:title" content="Azure Communication Services UI Library" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://azure.github.io/communication-ui-sdk/" />
<meta property="og:image" content="https://azure.github.io/communication-ui-sdk/images/ui-library-cover-image.png" />

<link href="https://fonts.cdnfonts.com/css/segoe-ui-4" rel="stylesheet">
<link rel="shortcut icon" href="./favicon.ico">

<style>
  /* Avoid sidebar header image getting very large */
  .sidebar-header img {
    max-height: 4rem;
  }

  /* Reduce sidebar header image padding from 20px to 10px */
  .sidebar-header>div:first-child {
    margin-right: 0.625rem;
  }
</style>

<script src="https://wcpstatic.microsoft.com/mscc/lib/v2/wcp-consent.js"></script>
<script>

  function addManageCookiesLink() {
    const sidebarContainer = document.getElementById('storybook-explorer-menu');
    if (!sidebarContainer) {
      // sidebar container has not loaded in the page yet, retry in 500ms
      setTimeout(addManageCookiesLink, 500);
      return false;
    }

    const linkId = 'manage-cookies';
    const existingLinkContainer = document.getElementById(linkId);
    if (existingLinkContainer) {
      sidebarContainer.removeChild(existingLinkContainer);
    }

    const linkContainer = document.createElement('div');
    linkContainer.id = linkId;
    linkContainer.style = 'text-align: center';
    const manageCookiesLink = document.createElement('a');
    manageCookiesLink.href = "javascript:;";
    manageCookiesLink.innerText = 'Manage Cookies';
    manageCookiesLink.style = 'color: #1EA7FD; font-size: 0.75rem;'
    manageCookiesLink.onclick = () => {
      window.siteConsent?.manageConsent();
    }
    linkContainer.appendChild(manageCookiesLink);
    sidebarContainer.appendChild(linkContainer);
  }

  window.addEventListener('load', () => {
    const cookieBannerId = 'cookie-banner';
    const cookieBannerContainer = document.createElement('div');
    cookieBannerContainer.id = cookieBannerId;
    document.body.insertBefore(cookieBannerContainer, document.body.firstChild);

    function onConsentChanged(categoryPreferences) {
      window.cookieConsentChanged && window.cookieConsentChanged();
    }

    function initCallback(err, _siteConsent) {
      if (!err) {
        siteConsent = _siteConsent; // siteConsent is used to get the current consent
        window.cookieConsentChanged && window.cookieConsentChanged(); // call callback now cookie library has finished initializing

        if (siteConsent?.isConsentRequired) {
          addManageCookiesLink();
        }
      } else {
        console.log(`Error initializing WcpConsent: ${err}`);
      }
    }

    window.WcpConsent && WcpConsent.init('en-US', cookieBannerId, initCallback, onConsentChanged, WcpConsent.themes.light);
  });
</script>

<script>
  function addUsefulLinks() {
    const linkStyle = 'color: black; text-decoration: none; text-align: center; cursor: pointer; padding: 0rem 0.5rem;';

    const sidebarHeader = document.getElementsByClassName('sidebar-header');
    if (sidebarHeader.length === 0) {
      // sidebar container has not loaded in the page yet, retry in 500ms
      console.log('sidebar-header not loaded');
      setTimeout(addUsefulLinks, 500);
      return false;
    }

    const sidebarNode = sidebarHeader[0].parentNode;

    // GitHub
    const githubImage = document.createElement('img');
    githubImage.src = './images/github.png';
    githubImage.style = 'height: 1rem;';

    const githubText = document.createElement('span');
    githubText.style = 'margin-left: 0.25rem;';
    githubText.innerText = 'GitHub';

    const repoLinkContent = document.createElement('span');
    repoLinkContent.style = 'display: flex;';
    repoLinkContent.append(githubImage, githubText);

    const repoLink = document.createElement('a');
    repoLink.href = 'https://github.com/Azure/communication-ui-library';
    repoLink.target='_blank';
    repoLink.style = linkStyle;
    repoLink.appendChild(repoLinkContent);

    // npm
    const npmImage = document.createElement('img');
    npmImage.src = './images/npm.png';
    npmImage.style = 'height: 1rem;';

    const npmText = document.createElement('span');
    npmText.style = 'margin-left: 0.25rem;';
    npmText.innerText = 'Npm';

    const npmLinkContent = document.createElement('span');
    npmLinkContent.style = 'display: flex;';
    npmLinkContent.append(npmImage, npmText);

    const npmLink = document.createElement('a');
    npmLink.href = 'https://www.npmjs.com/package/@azure/communication-react';
    npmLink.target='_blank';
    npmLink.style = linkStyle + ' margin-left: 0.5rem;';
    npmLink.appendChild(npmLinkContent);

    // links container
    const usefulLinksContainer = document.createElement('div');
    usefulLinksContainer.id = 'useful-links';
    usefulLinksContainer.style = 'display: flex; margin-top: 0.5rem; font-size: 0.875rem;';

    usefulLinksContainer.append(repoLink, npmLink);

    sidebarNode.insertBefore(usefulLinksContainer, sidebarNode.childNodes[1]);
  }

  window.addEventListener('load', () => {
    addUsefulLinks();
  });
</script>