import { Stack } from '@fluentui/react';
import { Meta } from '@storybook/addon-docs';
import { overviewPageImagesStackStyle } from './constants';

<Meta id="overview" title="Overview" parameters={{ previewTabs: { canvas: { disable: true, hidden: true } } }} />

<Stack horizontal horizontalAlign="space-between" style={overviewPageImagesStackStyle}>
  <Stack.Item align="center">
    <h2
      style={{
        fontFamily: '"Segoe UI", sans-serif',
        color: 'rgba(0,0,0,.5)',
        fontSize: '1.125rem',
        fontWeight: '500',
        border: 'none',
        margin: '0rem 0rem 0.25rem 0rem',
        lineHeight: '1.5rem'
      }}
    >
      Azure Communication Services
    </h2>
    <h1
      style={{
        fontFamily: '"Segoe UI", sans-serif',
        color: '#0078D4',
        fontWeight: '600',
        fontSize: '2rem',
        margin: '0rem',
        lineHeight: '2.5rem'
      }}
    >
      UI Library
    </h1>
  </Stack.Item>
  <Stack.Item align="center">
    <img src="images/hero.svg" alt="UI Library Hero Image" style={{ maxHeight: '18.75rem' }} />
  </Stack.Item>
</Stack>

Azure Communication Services - UI Library makes it easy for you to build modern communications user experiences using Azure Communication Services.
It gives you a library of production-ready UI components that you can drop into your applications:

- **Composites** - These components are turn-key solutions that implement common communication scenarios.
  You can quickly add video calling or chat experiences to your applications.
  Composites are open-source higher order components built using UI components.

- **UI Components** - These components are open-source building blocks that let you build custom communications experience.
  Components are offered for both calling and chat capabilities that can be combined to build experiences.

These UI client libraries all use [Microsoft's Fluent design language](https://developer.microsoft.com/fluentui/) and assets. Fluent UI provides a foundational layer for the UI Library and is actively used across Microsoft products.

In conjunction to the UI components, the UI Library exposes a _stateful client library_ for calling and chat.
This client is agnostic to any specific state management framework and can be integrated with common state managers like Redux or React Context.
This stateful client library can be used with the UI components to pass props and methods for the UI components to render data.
For more information, see [Stateful Client Overview](./?path=/docs/statefulclient-overview--page).

## Installing UI Library

```bash
npm i --save @azure/communication-react
```

## Composites Overview

Composites are higher-level components composed of UI components that deliver turn-key solutions for common communication scenarios using Azure Communication Services.
Developers can instantiate the composite using an Azure Communication Services access token and the required configuration attributed for call or chat.

### Call Composite [link](./?path=/docs/composites-call-basicexample--basic-example)

`Call Composite` is providing a calling experience that allows users to start or join a call. Inside the experience users can configure their
devices, participate in the call with video and see other participants, including those with video turn on.

Here are visual examples of the `Call Composite` where participants have their camera turned off, then some have them turned on.
People speaking with their microphone unmuted will have their tile appearing with a blue border.

<Stack horizontal horizontalAlign="space-between" tokens={{ childrenGap: '2rem' }} style={overviewPageImagesStackStyle}>
  <Stack.Item align="center">
    <img
      src="images/callComposite_CamerasOff.png"
      alt="Call Composite where all participants have their camera turned off"
    />
  </Stack.Item>
  <Stack.Item align="center">
    <img
      src="images/callComposite_CamerasOn.png"
      alt="Call composite where some participants have their camera turned on"
    />
  </Stack.Item>
</Stack>

When joining a Microsoft Teams call ([Teams Interop experience](./?path=/docs/examples-teamsinterop-compliancebanner--compliance-banner)), the
Call Composite includes a lobby experience where the user is waiting to be admitted into the call.

<Stack horizontal horizontalAlign="space-between" tokens={{ childrenGap: '3rem' }} style={overviewPageImagesStackStyle}>
  <Stack.Item align="center">
    <img
      src="images/callComposite_TeamsInterop_WaitingLobby.png"
      alt="Call composite waiting to be admitted in a Teams meeting"
    />
  </Stack.Item>
  <Stack.Item align="center" tokens={{ childrenGap: '2rem' }}>
    <p style={{ textAlign: 'center' }}>{'Popup appearing in Teams to admit ACS participant'}</p>
    <img
      src="images/callComposite_TeamsInterop_AdmissionFromTeams.png"
      alt="Popup in Teams to admit ACS participants"
    />
  </Stack.Item>
</Stack>

### Chat Composite [link](./?path=/docs/composites-chat-basicexample--basic-example)

`Chat Composite` is providing a chat experience where user can send and receive
messages. Message thread events such as typing indicators, whether the message has been successfully delivered or read, or participants entering
and leaving the chat are displayed to the user as part of the chat thread.

Here is a visual example of the `Chat Composite`.

<Stack style={overviewPageImagesStackStyle}>
  <Stack.Item align="center">
    <img src="images/chatComposite_NoParticipantsList.png" alt="Chat composite with the participants list" />
  </Stack.Item>
</Stack>

## UI Component Overview

Pure UI components that can be used by developers to compose communication experiences, from stitching video tiles into a grid to showcase remote participants, to organizing components to fit your applications specifications.
UI components support customization to give the components the right feel and look to match an applications branding and style.

Following are lists of components that can be used for specific areas.

### UI components for Calling

<Stack tokens={{ childrenGap: '3rem' }} style={overviewPageImagesStackStyle}>
  <Stack.Item align="center">
    <img src="images/components_calling.png" alt="example of components that can be used for calling" />
  </Stack.Item>
  <Stack.Item align="center">
    <img src="images/components_common.png" alt="example of components that can be used for chat" />
  </Stack.Item>
</Stack>

| Component                                                                         | Description                                                                                          |
| --------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------- |
| [Grid Layout](./?path=/docs/ui-components-gridlayout--grid-layout)                | Grid component to organize video tiles into an NxN grid                                              |
| [Video Tile](./?path=/docs/ui-components-videotile--video-tile)                   | Component that displays video stream when available and a default static component when not          |
| [Control Bar](./?path=/docs/ui-components-controlbar--control-bar)                | Container to organize `DefaultButtons` to hook up to specific call actions like mute or share screen |
| [Video Gallery](./?path=/docs/ui-components-videogallery--video-gallery)          | Turn-key video gallery component which dynamically changes as participants are added                 |
| [Participant Item](./?path=/docs/ui-components-participantitem--participant-item) | Common component to render a call or chat participant including avatar and display name              |
| [Participant List](./?path=/docs/ui-components-participantlist--participant-list) | Common component to render a call or chat participant list including avatar and display name         |

### UI components for Chat

<Stack style={overviewPageImagesStackStyle}>
  <Stack.Item align="center">
    <img src="images/components_chat.png" alt="example of components that can be used for chat" />
  </Stack.Item>
</Stack>

| Component                                                                                                | Description                                                                   |
| -------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------- |
| [Message Thread](./?path=/docs/ui-components-messagethread--message-thread)                              | Container that renders chat messages, system messages, and custom messages    |
| [Send Box](./?path=/docs/ui-components-sendbox--send-box)                                                | Text input component with a discrete send button                              |
| [Message Status Indicator](./?path=/docs/ui-components-messagestatusindicator--message-status-indicator) | Multi-state message status indicator component to show status of sent message |
| [Typing indicator](./?path=/docs/ui-components-typingindicator--typing-indicator)                        | Text component to render the participants who are actively typing on a thread |

## What UI artifact is best for my project?

Understanding these requirements will help you choose the right client library:

- **How much customization do you desire?** Azure Communication Services calling/chat SDKs don't have a UX and are designed so you can build whatever UX you want. UI Library components provide UI assets at the cost of reduced customization.
- **What platforms are you targeting?** Different platforms have different capabilities.

Details about feature availability in the [UI Library is available here](./?path=/docs/usecases--page), but key trade-offs are summarized below.

| Client library / SDK  | Implementation complexity | Customization ability | Calling | Chat | [Teams Interop](https://docs.microsoft.com/azure/communication-services/concepts/teams-interop) |
| --------------------- | ------------------------- | --------------------- | ------- | ---- | ----------------------------------------------------------------------------------------------- |
| Composite components  | Low                       | Low                   | ✔       | ✔    | ✔                                                                                               |
| Base components       | Medium                    | Medium                | ✔       | ✔    | ✔                                                                                               |
| Core client libraries | High                      | High                  | ✔       | ✔    | ✔                                                                                               |

## Platform support

| SDK              | Windows                       | macOS                         | Ubuntu   | Linux    | Android    | iOS          |
| ---------------- | ----------------------------- | ----------------------------- | -------- | -------- | ---------- | ------------ |
| UI SDK - Calling | Chrome\*, new Edge            | Chrome\*, Safari\*\*          | Chrome\* | Chrome\* | Chrome\*\* | Safari\*\*\* |
| UI SDK - Chat    | Firefox\*, Chrome\*, new Edge | Firefox\*, Chrome\*, Safari\* | Chrome\* | Chrome\* | Safari\*   |

\*Note that the latest version is supported in addition to the
previous two releases.

\*\*Note that outgoing screen sharing is not supported for Chrome on Android.

\*\*\*Note that Safari versions 13.1+ are supported. 1:1 calls are not supported on Safari. Outgoing video for Safari
macOS supported only for Safari 14+/macOS 11+. Outgoing screen sharing
is not supported on iOS, device selection(for example choosing Bluetooth headset) is limited by OS, only one device available.
