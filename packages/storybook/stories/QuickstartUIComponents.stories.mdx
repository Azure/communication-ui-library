import { Meta } from '@storybook/addon-docs/blocks';
import { Canvas, Description, Heading, Props, Source, Title } from '@storybook/addon-docs/blocks';

<Meta title="Quickstart: UI Components" />

# Quickstart: Get started with UI Components

Get started with Azure Communication Services by using the UI Framework to quickly integrate communication experiences into your applications. In this quickstart, you'll learn how integrate UI Framework base components into your application to build communication experiences.

UI Framework components come in two flavors: Base and Composite.

- **Base components** represent discrete communication capabilities; they're the basic building blocks that can be used to build complex communication experiences.
- **Composite components** are turn-key experiences for common communication scenarios that have been built using **base components** as building blocks and packaged to be easily integrated into applications.

## Prerequisites

- An Azure account with an active subscription. [Create an account for free](https://azure.microsoft.com/free/?WT.mc_id=A261C142F).
- [Node.js](https://nodejs.org/) Active LTS and Maintenance LTS versions (Node 12 Recommended).
- An active Communication Services resource. [Create a Communication Services resource](https://docs.microsoft.com/azure/communication-services/quickstarts/create-communication-resource?tabs=windows&pivots=platform-azp).

## Setting up

UI Framework requires a React environment to be setup. Next we will do that. If you already have a React App, you can skip this section.

### Set Up React App

We'll use the create-react-app template for this quickstart. For more information, see: [Get Started with React](https://reactjs.org/docs/create-a-new-react-app.html)

```bash

# Build app in typescript:
npx create-react-app UI-ToolKit-Quickstart --template typescript

cd UI-ToolKit-Quickstart

```

At the end of this process, you should have a full application inside of the folder `UI-ToolKit-Quickstart`.
For this quickstart, we'll be modifying files inside of the `src` folder.

### Install the package

Use the `npm install` command to install the Azure Communication Services UI Toolkit for JavaScript.
Move the provided tarball (Private Preview) over to the `UI-ToolKit-Quickstart` directory. **Make sure to run the `npm i` command inside the `UI-ToolKit-Quickstart` directory.**

```bash

# For Private Preview install tarball

npm install --save ./{path for tarball}

```

The `--save` option lists the library as a dependency in your **package.json** file.

### Run Create React App

Let's test the Create React App installation by running:

```bash

npm run start

```

## Object model

The following classes and interfaces handle some of the major features of the Azure Communication Services UI client library:

| Name                                                                          | Description                                                                              |
| ----------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------- |
| [FluentThemeProvider](/?path=/story/theming--page)                            | Provider that controls Theming on the components. Can be used to override theme          |
| [GridLayout](/?path=/story/ui-components-gridlayout--grid-layout-component)   | Base component that organizes video tiles into a grid                                    |
| [Video Tile](/?path=/story/ui-components-videotile--video-tile-component)     | Base component to render participants either with or without video                       |
| [ControlBar](/?path=/story/ui-components-controlbar--control-bar-component)   | Base component to control call including mute, video, share screen                       |
| [ChatThread](/?path=/docs/ui-components-chatthread--chat-thread-component)    | Base component that renders a chat thread with typing indicators, read receipts, etc.    |
| [SendBox](/?path=/story/ui-components-sendbox--send-box-story-book-component) | Base component that allows user to input messages that will be sent to the joined thread |

## Set Up Fluent Theme Provider

The `FluentThemeProvider` is a required wrapper around the UI Toolkit components to provide theming that makes the components look amazing!
It is in charge of allowing developer customize the theme of the components as well. Check out [Theming](/?path=/story/theming--page) for more information. `FluentThemeProvider` defaults to using light theme.

`App.tsx`

```jsx
import React from 'react';
import { FluentThemeProvider } from '@azure/communication-ui';

function App(props) {
  return <FluentThemeProvider>{/*Add Components!*/}</FluentThemeProvider>;
}

export default App;
```

Inside the `FluentThemeProvider`, you can add additional components.
Next we'll use various UI components to showcase a sample experience.
You can customize the layout of these components and add any other custom components that you want to render with them.

## Add Calling UI Components

For Calling, we'll use the [`GridLayout`](/?path=/story/ui-components-gridlayout--grid-layout-component) and [`ControlBar`](/?path=/story/ui-components-controlbar--control-bar-component) Components.
To start, in the `src` folder, create a new file called `CallingComponents.tsx`.
Here we'll initialize a function component that will hold our base components to then import in `app.tsx`.
You can add extra layout and styling around the components.

`CallingComponents.tsx`

```jsx
import {
  GridLayoutComponent,
  VideoTile,
  ControlBar,
  videoButtonProps,
  audioButtonProps,
  screenShareButtonProps,
  optionsButtonProps,
  hangupButtonProps
} from '@azure/communication-ui';
import { DefaultButton, Stack, IContextualMenuProps } from '@fluentui/react';
import { useState } from 'react';

export function CallingComponents() {
  const exampleOptionsMenuProps: IContextualMenuProps = {
    items: [
      {
        key: '1',
        name: 'Choose Camera',
        iconProps: { iconName: 'LocationCircle' },
        onClick: () => alert('Choose Camera Menu Item Clicked!')
      }
    ]
  };
  const [videoButtonChecked, setVideoButtonChecked] = useState < boolean > false;
  const [audioButtonChecked, setAudioButtonChecked] = useState < boolean > false;
  const [screenshareButtonChecked, setScreenshareButtonChecked] = useState < boolean > false;

  return (
    <Stack>
      {/* GridLayout Component relies on the parent's height and width, so it's required to set the height and width on its parent. */}
      <div style={{ height: '30rem', width: '30rem', border: '1px solid' }}>
        <GridLayoutComponent>
          <VideoTile isVideoReady={false} videoProvider={null} avatarName={'Michael'}>
            <label>Michael</label>
          </VideoTile>
        </GridLayoutComponent>
      </div>

      {/* Control Bar with default set up */}
      <ControlBar styles={{ root: { justifyContent: 'center' } }}>
        <DefaultButton
          {...videoButtonProps}
          checked={videoButtonChecked}
          onClick={() => setVideoButtonChecked(!videoButtonChecked)}
        />
        <DefaultButton
          {...audioButtonProps}
          checked={audioButtonChecked}
          onClick={() => setAudioButtonChecked(!audioButtonChecked)}
        />
        <DefaultButton
          {...screenShareButtonProps}
          checked={screenshareButtonChecked}
          onClick={() => setScreenshareButtonChecked(!screenshareButtonChecked)}
        />
        <DefaultButton {...optionsButtonProps} menuProps={exampleOptionsMenuProps} />
        <DefaultButton {...hangupButtonProps} />
      </ControlBar>
    </Stack>
  );
}
```

For this example we added a single `Video Tile` to the grid, but additional can be added.

## Add Chat UI Components

For Chat, we will use the [`ChatThread`](/?path=/docs/ui-components-chatthread--chat-thread-component) and [`SendBox`](/?path=/docs/ui-components-sendbox--send-box-story-book-component) components.
To start, in the `src` folder, create a new file called `ChatComponents.tsx`.
Here we'll initialize a function component that will hold our base components to then import in `app.tsx`.

`ChatComponents.tsx`

```jsx
import {ChatThreadComponentBase, ChatMessage as WebUiChatMessage, SendBoxComponent, MessageStatus } from '@azure/communication-ui'

export const ChatComponents = () => {
  //A sample chat history
  const GetHistoryChatMessages = (): WebUiChatMessage[] => {
    return [
      {
        senderId: '1',
        senderDisplayName: 'User1',
        messageId: Math.random().toString(),
        content: 'Hi everyone, I created this awesome group chat for us!',
        createdOn: new Date('2019-04-13T00:00:00.000+08:10'),
        mine: true,
        attached: false,
        statusToRender: 'seen' as MessageStatus
      },
      {
        senderId: '2',
        senderDisplayName: 'User2',
        messageId: Math.random().toString(),
        content: 'Nice! This looks great!',
        createdOn: new Date('2019-04-13T00:00:00.000+08:09'),
        mine: false,
        attached: false
      },
      {
        senderId: '3',
        senderDisplayName: 'User3',
        messageId: Math.random().toString(),
        content: "Yeah agree, let's chat here from now on!",
        createdOn: new Date('2019-04-13T00:00:00.000+08:09'),
        mine: false,
        attached: false
      }
    ];
  };

  return (
    <div style = {{height: '30rem', width: '30rem'}}>
      {/* Chat thread component with read receipt feature enabled */}
      <ChatThreadComponentBase
        userId={'1'}
        chatMessages={GetHistoryChatMessages()}
        disableReadReceipt={false}
      />

      <SendBoxComponent
        disabled={false}
        sendMessage={async () => { return }}
        userId='ACS_ID PLACEHOLDER'
        displayName='User Name'
        onSendTypingNotification={async () => { return }}
      />
    </div >
  );
}
```

## Add Calling and Chat Components to the main application

Back in the `app.tsx` file, we will now add the components to the `FluentThemeProvider` like shown below.

`App.tsx`

```jsx
import { FluentThemeProvider } from '@azure/communication-ui';
import { Stack } from '@fluentui/react';
import { CallingComponents } from './CallingComponents';
import { ChatComponents } from './ChatComponents';

function App() {
  return (
    <FluentThemeProvider>
      <Stack
        horizontal
        horizontalAlign="space-evenly"
        styles={{
          root: { width: '100%' }
        }}
      >
        <CallingComponents />
        <ChatComponents />
      </Stack>
    </FluentThemeProvider>
  );
}

export default App;
```

## Run quickstart

To run the code above use the command:

```console

npm run start

```

## Clean up resources

If you want to clean up and remove a Communication Services subscription, you can delete the resource or resource group.
Deleting the resource group also deletes any other resources associated with it.
Learn more about [cleaning up resources](https://docs.microsoft.com/azure/communication-services/quickstarts/create-communication-resource?tabs=windows&pivots=platform-azp#clean-up-resources).

## Next steps

[Try UI Toolkit Composite Components](/?path=/story/quickstart-composites--page)

For more information, see the following resources:

- [UI Toolkit Use Cases](/?path=/story/use-cases--page)
- [UI Toolkit Styling](/?path=/story/styling--page)
- [UI Toolkit Theming](/?path=/story/theming--page)
