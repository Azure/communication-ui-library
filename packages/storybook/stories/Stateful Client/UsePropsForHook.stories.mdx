import { Meta } from '@storybook/addon-docs/blocks';
import { Canvas, Description, Heading, Props, Source, Title } from '@storybook/addon-docs/blocks';

<Meta id="statefulclient-reacthooks-usepropsfor" title="Stateful Client/React Hooks/UsePropsFor" />

# usePropsFor <a name="usePropsFor"></a>

If you are using React Component from our communication-react components, usePropsFor is the go-to hook.
It provides all the required props to power a feature component.
It subscribes to state changes of stateful clients, gets props designed for your component, and triggers a re-render whenever the props change.

To see a full end-to-end example using usePropsFor, see [Getting Started with StatefulClient](/?path=/docs/quickstarts-statefulclient--page)

## _usePropsFor_ Calling App Example

```tsx
import React from 'react';
import { VideoGallery, usePropsFor } from '@azure/communication-react';

export const ChatScreen = () => {
  const props = usePropsFor(VideoGallery);
  return <VideoGallery {...props} />;
};
```

## _usePropsFor_ Chat App Example

```tsx
import React from 'react';
import { MessageThread, usePropsFor } from '@azure/communication-react';

export const ChatScreen = () => {
  const props = usePropsFor(MessageThread);
  return <MessageThread {...props} />;
};
```

`usePropsFor` supports the following components:

_Chat_

- [MessageThread](/?path=/docs/ui-components-messagethread--message-thread)
- [SendBox](/?path=/docs/ui-components-sendbox--send-box)
- [TypingIndicator](/?path=/docs/ui-components-typingindicator--typing-indicator)
- [ParticipantList](/?path=/docs/ui-components-participantlist--participant-list)

_Calling_

- [VideoGallery](/?path=/docs/ui-components-videogallery--video-gallery)
- [ParticipantList](/?path=/docs/ui-components-participantlist--participant-list)
- [CameraButton](/?path=/docs/ui-components-controlbar-buttons-camera--camera)
- [EndCallButton](/?path=/docs/ui-components-controlbar-buttons-endcall--end-call)
- [MicrophoneButton](/?path=/docs/ui-components-controlbar-buttons-microphone--microphone)
- [OptionsButton](/?path=/docs/ui-components-controlbar-buttons-options--options)
- [ScreenShareButton](/?path=/docs/ui-components-controlbar-buttons-screenshare--screen-share)

## Choose your flavors

usePropsFor() is context-awared so no need to worry which Provider you are using, there is only one exception:
If usePropsFor() is under both ChatClientProvider and CallingClientProvider, and you are getting ParicipantList props -
Since ParticipantList is a shared component between calling and chat, usePropsFor can't determine which side of data you want to collect.
You need to pass the flavor parameter to usePropsFor() when it happens:

```
const chatPariticipantProps = usePropsFor(ParticipantList, 'chat');
const callingPariticipantProps = usePropsFor(ParticipantList, 'calling');
```

## Under the Hood of usePropsFor

usePropsFor() is a function that provides all you need to run a component in our library.
It combines 2 tasks for generating the component's props for you:

1. Finds the right selector designed for the component, then call useSelector()
2. Constructs a set of handlers tailored for the component

## Using usePropsFor with Custom Components

You can use the usePropsFor function for your own custom components by matching the props structure of the supported UI Components.
By passing the component that matches your custom components prop structure, you can then use the outputted props on your own custom component.
This means you could build your own `Video Gallery` with a custom layout using our `Grid Layout` and `Video Tile` components, and still leverage our usePropsFor helper.
In cases, where matching the prop structure is not possible, the stateful clients can still be leveraged to extract and maintain your own props.
For more information, see [useSelector](/?path=/docs/statefulclient-reacthooks-useselector--page).
