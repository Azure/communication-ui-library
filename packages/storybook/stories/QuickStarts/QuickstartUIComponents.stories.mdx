import { Canvas, Meta, Source } from '@storybook/addon-docs';
import CompletedComponentsApp from './snippets/CompletedComponentsApp.snippet';
import AppText from '!!raw-loader!./snippets/App.snippet.tsx';
import CallingComponentsText from '!!raw-loader!./snippets/CallingComponents.tsx';
import ChatComponentsText from '!!raw-loader!./snippets/ChatComponents.tsx';
import CompletedComponentsAppText from '!!raw-loader!./snippets/CompletedComponentsApp.snippet.tsx';

<Meta
  id="quickstarts-uicomponents"
  title="UI Components/Get Started"
  parameters={{ previewTabs: { canvas: { disable: true, hidden: true } } }}
/>

# Quickstart: Get started with UI Components

Get started with Azure Communication Services by using the UI Library to quickly integrate communication experiences into your applications. In this quickstart, you'll learn how to integrate UI Library base components into your application to build communication experiences.

UI Library components come in two flavors: UI and Composite.

- **UI components** represent discrete communication capabilities; they're the basic building blocks that can be used to build complex communication experiences.
- **Composite components** are turn-key experiences for common communication scenarios that have been built using **base components** as building blocks and packaged to be easily integrated into applications.

## Download the code

You can find the completed code for this quickstart here: [Get started with UI Components](https://github.com/Azure-Samples/communication-services-javascript-quickstarts/tree/main/ui-library-quickstart-ui-components)

## Prerequisites

- An Azure account with an active subscription. [Create an account for free](https://azure.microsoft.com/free/?WT.mc_id=A261C142F).
- [Node.js](https://nodejs.org/) Active LTS and Maintenance LTS versions (Node 12 Recommended).

## Setting Up

UI Library requires a React environment to be setup. Next we will do that. If you already have a React App, you can skip this section.

### Set Up React App

We'll use the create-react-app template for this quickstart. For more information, see: [Get Started with React](https://reactjs.org/docs/create-a-new-react-app.html)

```bash

npx create-react-app ui-library-quickstart --template typescript

cd ui-library-quickstart

```

At the end of this process, you should have a full application inside the folder `UI-library-Quickstart`.
For this quickstart, we'll be modifying files inside the `src` folder.

### Install the Package

Use the `npm install` command to install the Azure Communication Services UI Library for JavaScript.

```bash

npm install --save @azure/communication-react

```

**Beta-channel setup**

`@azure/communication-react` is in the process of migrating the core Azure Communication Services dependencies to `peerDependencies` so that
you can most consistently use the API from the core libraries in your application.

If you are using a beta package (has a `beta` suffix) >= `@azure/communication-react@1.0.1-beta.2`, you need to install
the low-level client libraries as well:

```bash

npm install @azure/communication-calling@1.3.2-beta.1
npm install @azure/communication-chat@1.1.0

```

### Run Create React App

Let's test the Create React App installation by running:

```bash

npm run start

```

## Object Model

The following classes and interfaces handle some of the major features of the Azure Communication Services UI client library:

| Name                                                                        | Description                                                                              |
| --------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------- |
| [FluentThemeProvider](./?path=/story/theming--page)                         | Provider that controls Theming on the components. Can be used to override theme          |
| [GridLayout](./?path=/story/ui-components-gridlayout--grid-layout)          | Base component that organizes video tiles into a grid                                    |
| [VideoTile](./?path=/story/ui-components-videotile--video-tile)             | Base component to render participants either with or without video                       |
| [ControlBar](./?path=/story/ui-components-controlbar--control-bar)          | Base component to control call including mute, video, share screen                       |
| [MessageThread](./?path=/story/ui-components-messagethread--message-thread) | Base component that renders a chat thread with typing indicators, read receipts, etc.    |
| [SendBox](./?path=/story/ui-components-sendbox--send-box)                   | Base component that allows user to input messages that will be sent to the joined thread |

## Set Up Fluent Theme Provider and Icons

The `FluentThemeProvider` is a required wrapper around the UI Library components to provide theming that makes the components look amazing!
It is in charge of allowing developer customize the theme of the components as well. Check out [Theming](./?path=/story/theming--page) for more information. `FluentThemeProvider` defaults to using light theme.

`App.tsx`

<Source code={AppText} />

Inside the `FluentThemeProvider`, you can add additional components.
Next we'll use various UI components to showcase a sample experience.
You can customize the layout of these components and add any other custom components that you want to render with them.

## Calling UI Components

For Calling, we'll use the [`GridLayout`](./?path=/story/ui-components-gridlayout--grid-layout-component) and [`ControlBar`](./?path=/story/ui-components-controlbar--control-bar) components.
To start, in the `src` folder, create a new file called `CallingComponents.tsx`.
Here we'll initialize a function component that will hold our base components to then import in `app.tsx`.
You can add extra layout and styling around the components.

`CallingComponents.tsx`

<Source code={CallingComponentsText} />

For this example we added a single `Video Tile` to the grid, but additional can be added.

## Chat UI Components

For Chat, we will use the [`MessageThread`](./?path=/docs/ui-components-chatthread--chat-thread-component) and [`SendBox`](./?path=/docs/ui-components-sendbox--send-box-story-book-component) components.
To start, in the `src` folder, create a new file called `ChatComponents.tsx`.
Here we'll initialize a function component that will hold our base components to then import in `app.tsx`.

`ChatComponents.tsx`

<Source code={ChatComponentsText} />

## Add Calling and Chat Components

Back in the `app.tsx` file, we will now add the components to the `FluentThemeProvider` like shown below.

`App.tsx`

<Source code={CompletedComponentsAppText} />
<Canvas withSource="none">
  <CompletedComponentsApp />
</Canvas>

## Run Quickstart

To run the code above use the command:

```console

npm run start

```

## Troubleshooting

See the [troubleshooting page](./?path=/story/troubleshooting--page) for some common problems and recommended solutions.

## Clean Up Resources

If you want to clean up and remove a Communication Services subscription, you can delete the resource or resource group.
Deleting the resource group also deletes any other resources associated with it.
Learn more about [cleaning up resources](https://docs.microsoft.com/azure/communication-services/quickstarts/create-communication-resource?tabs=windows&pivots=platform-azp#clean-up-resources).

## Next Steps

[Try UI Library Stateful Client](./?path=/story/quickstarts-statefulclient--page)

For more information, see the following resources:

- [UI Library Use Cases](./?path=/story/use-cases--page)
- [UI Library Styling](./?path=/story/styling--page)
- [UI Library Theming](./?path=/story/theming--page)
