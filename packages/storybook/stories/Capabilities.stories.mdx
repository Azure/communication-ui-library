import { Meta, Source } from '@storybook/addon-docs';
import { SingleLineBetaBanner } from './BetaBanners/SingleLineBetaBanner';

import CapabilitiesChangedListenerSnippetText from '!!raw-loader!./snippets/capabilities/CapabilitiesChangedListener.snippet.tsx';

<Meta
  id="capabilities"
  title="Concepts/Capablities"
  parameters={{ previewTabs: { canvas: { disable: true, hidden: true } } }}
/>

# Capabilities

## Overview

Capabilities are actions that ACS users can perform during a call are controlled based on their role. Capabilites are only
present in certain types of calls like the Teams interop scenario.

The capabilities of an ACS user are reflected in the Call and CallWithChat composites by disabling controls and notifications.
For example, when the ACS user loses the capability to turn on their video and share their screen this will be reflected in
the call composite like shown in the screenshot below.

<img style={{ width: 'auto', height: 'auto' }} src="images/capabilities-in-call-composite.png" />

Currently the only capabilities that are reflected in the Teams interop scenario are:

- unmuting microphone
- turning on video
- sharing screen

For the Teams interop scenario, user roles and capabilities can be configured in Teams by the meeting organizer through
'Meeting options' like the screenshot below.

<img style={{ width: 'auto', height: 'auto' }} src="images/teams-meeting-options.png" />

To learn more about the capabilities available for each role in a Teams meeting click
[here](https://support.microsoft.com/en-us/office/roles-in-microsoft-teams-meetings-c16fa7d0-1666-4dde-8686-0a0bfe16e019)

Rooms calls also have roles for ACS users which define their capabilities. Rooms call are supported in beta version
**1.3.2-beta.1** or later. To learn more about Rooms calls and the different roles within click [here](path=/docs/rooms).

## Teams policies

Teams policies can be assigned to Teams users which also control which capabilities of Teams users in a tenant. To
learn more about Teams policies click
[here](https://learn.microsoft.com/en-us/microsoftteams/assign-policies-users-and-groups). Currently, only some
capabilities like share screen are reflected in Teams meeting when using Teams identity. Teams policies cannot be
applied to ACS users.

## Handling changes of capabilities

The [CallAdapter](path=/docs/composite-adapters--page#call-adapter) is able to listen for `capabilitiesChanged` events
and allows you to handle these events by defining your own `CapabilitiesChangedListener` callback. The following code
snippet shows an example of a `CapabilitiesChangedListener` that simply logs the capabilities changed info to the
browser console.

<Source code={CapabilitiesChangedListenerSnippetText} />

It is important to note using the CapabilitiesChangedListener` callback will not override the behavior of the Call and
CallWithChat composite that handles enabling/disabling controls and show notifications based on the capabilities
changed.
