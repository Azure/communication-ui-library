import { Meta, Source } from '@storybook/addon-docs';

import indexText from '!!raw-loader!./snippets/ReactIndex.snippet.tsx';

<Meta
  id="setup-communication-react"
  title="Setup"
  parameters={{ previewTabs: { canvas: { disable: true, hidden: true } } }}
/>

# Setting up your app to use Azure Communications UI Library

Currently the Azure Communications UI library supports react versions `>= 16.8.0` or ` < 18`

Using the UI library in react developers will need to downgrade the version of react that they are currently
getting from `create-react-app`. This page talks about packages that need downgrading and files that should be edited to
get you up and running.

## Prerequisites

- An Azure account with an active subscription. [Create an account for free](https://azure.microsoft.com/free/?WT.mc_id=A261C142F).
- [Node.js](https://nodejs.org/) Active LTS and Maintenance LTS versions (Node 14.19.0 and above).
- An active Communication Services resource. [Create a Communication Services resource](https://docs.microsoft.com/azure/communication-services/quickstarts/create-communication-resource?tabs=windows&pivots=platform-azp).
- An identity with both VoIP and Chat scopes. Generate an identity using the [Azure Portal](https://docs.microsoft.com/azure/communication-services/quickstarts/identity/quick-create-identity).

## Setting Up

UI Library requires a React environment to be setup. Next we will do that. If you already have a React App, you can skip this section.

### Set Up React App

We'll use the create-react-app template for this quickstart. For more information, see: [Get Started with React](https://reactjs.org/docs/create-a-new-react-app.html)

```bash

npx create-react-app your-ui-lib-application --template typescript

cd your-ui-lib-application

```

### Editing your files

Once the create script has finished you will need to edit your `index.tsx` file to a older version.

<Source code={indexText} />

The newest version of react react 18 changes how your index.tsx file would look so this change is needed. In our
various tutorials we will show you how to setup your `App.tsx` file but `index.tsx` needs to be updated in
this way due to changes to `ReactDom` in `React 18`.

### Setting up your React app packages

Since React 18 also updates all of its dependencies we will need to make sure that we downgrade the react packages present in
react versions `16.8.0` to versions `< 18`.

A recommended coniguration for the dependencies of your project can be found here:

```json
"dependencies": {
    "@testing-library/jest-dom": "^5.16.5",
    "@testing-library/react-hooks": "^3.4.2",
    "@testing-library/user-event": "^13.5.0",
    "@types/jest": "^27.5.2",
    "@types/node": "^16.11.49",
    "@types/react": "^16.9.49",
    "@types/react-dom": "^16.9.8",
    "react": "~16.14.0",
    "react-dom": "16.13.1",
    "react-router-dom": "^5.1.2",
    "react-scripts": "^5.0.1",
    "react-test-renderer": "^16.14.0",
    "reactstrap": "^8.4.1",
    "typescript": "^4.7.4",
    "web-vitals": "^2.1.4"
}
```

Should you want to update anything make sure that it is compatible with react versions `< 18`

### Installing the Package

Use the `npm install` command to install the Azure Communication Services UI Library for JavaScript.

```bash
npm install @azure/communication-react
```

`@azure/communication-react` specifies core AzureCommunication Services as `peerDependencies` so that you
can most consistently user the API from the core libraries in your application. You need to install those libraries as well:

```bash
npm install @azure/communication-calling@1.4.4
npm install @azure/communication-chat@1.2.0
```

Another useful library to install for working with our [composite adapters](./?path=/docs/quickstarts-composites--page) is `uuid`

```bash
npm install uuid
```

### Run Create React App

Let's test the Create React App installation by running:

```bash

npm run start

```
