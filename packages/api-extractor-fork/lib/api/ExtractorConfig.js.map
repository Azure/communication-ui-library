{"version":3,"file":"ExtractorConfig.js","sourceRoot":"","sources":["../../src/api/ExtractorConfig.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\r\n// See LICENSE in the project root for license information.\r\n\r\nimport * as path from 'path';\r\nimport * as resolve from 'resolve';\r\nimport lodash = require('lodash');\r\nimport {\r\n  JsonFile,\r\n  JsonSchema,\r\n  FileSystem,\r\n  PackageJsonLookup,\r\n  INodePackageJson,\r\n  PackageName,\r\n  Text,\r\n  InternalError,\r\n  Path,\r\n  NewlineKind\r\n} from '@rushstack/node-core-library';\r\nimport { RigConfig } from '@rushstack/rig-package';\r\n\r\nimport { IConfigFile, IExtractorMessagesConfig } from './IConfigFile';\r\nimport { PackageMetadataManager } from '../analyzer/PackageMetadataManager';\r\nimport { MessageRouter } from '../collector/MessageRouter';\r\nimport { TSDocConfiguration } from '@microsoft/tsdoc';\r\nimport { TSDocConfigFile } from '@microsoft/tsdoc-config';\r\n\r\n/**\r\n * Tokens used during variable expansion of path fields from api-extractor.json.\r\n */\r\ninterface IExtractorConfigTokenContext {\r\n  /**\r\n   * The `<unscopedPackageName>` token returns the project's NPM package name, without any NPM scope.\r\n   * If there is no associated package.json file, then the value is `unknown-package`.\r\n   *\r\n   * Example: `my-project`\r\n   */\r\n  unscopedPackageName: string;\r\n\r\n  /**\r\n   * The `<packageName>` token returns the project's full NPM package name including any NPM scope.\r\n   * If there is no associated package.json file, then the value is `unknown-package`.\r\n   *\r\n   * Example: `@scope/my-project`\r\n   */\r\n  packageName: string;\r\n\r\n  /**\r\n   * The `<projectFolder>` token returns the expanded `\"projectFolder\"` setting from api-extractor.json.\r\n   */\r\n  projectFolder: string;\r\n}\r\n\r\n/**\r\n * Options for {@link ExtractorConfig.tryLoadForFolder}.\r\n *\r\n * @public\r\n */\r\nexport interface IExtractorConfigLoadForFolderOptions {\r\n  /**\r\n   * The folder path to start from when searching for api-extractor.json.\r\n   */\r\n  startingFolder: string;\r\n\r\n  /**\r\n   * An already constructed `PackageJsonLookup` cache object to use.  If omitted, a temporary one will\r\n   * be constructed.\r\n   */\r\n  packageJsonLookup?: PackageJsonLookup;\r\n\r\n  /**\r\n   * An already constructed `RigConfig` object.  If omitted, then a new `RigConfig` object will be constructed.\r\n   */\r\n  rigConfig?: RigConfig;\r\n}\r\n\r\n/**\r\n * Options for {@link ExtractorConfig.prepare}.\r\n *\r\n * @public\r\n */\r\nexport interface IExtractorConfigPrepareOptions {\r\n  /**\r\n   * A configuration object as returned by {@link ExtractorConfig.loadFile}.\r\n   */\r\n  configObject: IConfigFile;\r\n\r\n  /**\r\n   * The absolute path of the file that the `configObject` object was loaded from.  This is used for error messages\r\n   * and when probing for `tsconfig.json`.\r\n   *\r\n   * @remarks\r\n   *\r\n   * If `configObjectFullPath` and `projectFolderLookupToken` are both unspecified, then the api-extractor.json\r\n   * config file must explicitly specify a `projectFolder` setting rather than relying on the `<lookup>` token.\r\n   */\r\n  configObjectFullPath: string | undefined;\r\n\r\n  /**\r\n   * The parsed package.json file for the working package, or undefined if API Extractor was invoked without\r\n   * a package.json file.\r\n   *\r\n   * @remarks\r\n   *\r\n   * If omitted, then the `<unscopedPackageName>` and `<packageName>` tokens will have default values.\r\n   */\r\n  packageJson?: INodePackageJson | undefined;\r\n\r\n  /**\r\n   * The absolute path of the file that the `packageJson` object was loaded from, or undefined if API Extractor\r\n   * was invoked without a package.json file.\r\n   *\r\n   * @remarks\r\n   *\r\n   * This is used for error messages and when resolving paths found in package.json.\r\n   *\r\n   * If `packageJsonFullPath` is specified but `packageJson` is omitted, the file will be loaded automatically.\r\n   */\r\n  packageJsonFullPath: string | undefined;\r\n\r\n  /**\r\n   * The default value for the `projectFolder` setting is the `<lookup>` token, which uses a heuristic to guess\r\n   * an appropriate project folder.  Use `projectFolderLookupValue` to manually specify the `<lookup>` token value\r\n   * instead.\r\n   *\r\n   * @remarks\r\n   * If the `projectFolder` setting is explicitly specified in api-extractor.json file, it should take precedence\r\n   * over a value specified via the API.  Thus the `projectFolderLookupToken` option provides a way to override\r\n   * the default value for `projectFolder` setting while still honoring a manually specified value.\r\n   */\r\n  projectFolderLookupToken?: string;\r\n\r\n  /**\r\n   * Allow customization of the tsdoc.json config file.  If omitted, this file will be loaded from its default\r\n   * location.  If the file does not exist, then the standard definitions will be used from\r\n   * `@microsoft/api-extractor/extends/tsdoc-base.json`.\r\n   */\r\n  tsdocConfigFile?: TSDocConfigFile;\r\n}\r\n\r\ninterface IExtractorConfigParameters {\r\n  projectFolder: string;\r\n  packageJson: INodePackageJson | undefined;\r\n  packageFolder: string | undefined;\r\n  mainEntryPointFilePath: string;\r\n  bundledPackages: string[];\r\n  tsconfigFilePath: string;\r\n  overrideTsconfig: {} | undefined;\r\n  skipLibCheck: boolean;\r\n  apiReportEnabled: boolean;\r\n  reportFilePath: string;\r\n  reportTempFilePath: string;\r\n  docModelEnabled: boolean;\r\n  apiJsonFilePath: string;\r\n  rollupEnabled: boolean;\r\n  untrimmedFilePath: string;\r\n  betaTrimmedFilePath: string;\r\n  publicTrimmedFilePath: string;\r\n  omitTrimmingComments: boolean;\r\n  tsdocMetadataEnabled: boolean;\r\n  tsdocMetadataFilePath: string;\r\n  tsdocConfigFile: TSDocConfigFile;\r\n  tsdocConfiguration: TSDocConfiguration;\r\n  newlineKind: NewlineKind;\r\n  messages: IExtractorMessagesConfig;\r\n  testMode: boolean;\r\n}\r\n\r\n/**\r\n * The `ExtractorConfig` class loads, validates, interprets, and represents the api-extractor.json config file.\r\n * @public\r\n */\r\nexport class ExtractorConfig {\r\n  /**\r\n   * The JSON Schema for API Extractor config file (api-extractor.schema.json).\r\n   */\r\n  public static readonly jsonSchema: JsonSchema = JsonSchema.fromFile(\r\n    path.join(__dirname, '../schemas/api-extractor.schema.json')\r\n  );\r\n\r\n  /**\r\n   * The config file name \"api-extractor.json\".\r\n   */\r\n  public static readonly FILENAME: string = 'api-extractor.json';\r\n\r\n  /**\r\n   * The full path to `extends/tsdoc-base.json` which contains the standard TSDoc configuration\r\n   * for API Extractor.\r\n   * @internal\r\n   */\r\n  public static readonly _tsdocBaseFilePath: string = path.resolve(\r\n    __dirname,\r\n    '../../extends/tsdoc-base.json'\r\n  );\r\n\r\n  private static readonly _defaultConfig: Partial<IConfigFile> = JsonFile.load(\r\n    path.join(__dirname, '../schemas/api-extractor-defaults.json')\r\n  );\r\n\r\n  private static readonly _declarationFileExtensionRegExp: RegExp = /\\.d\\.ts$/i;\r\n\r\n  /** {@inheritDoc IConfigFile.projectFolder} */\r\n  public readonly projectFolder: string;\r\n\r\n  /**\r\n   * The parsed package.json file for the working package, or undefined if API Extractor was invoked without\r\n   * a package.json file.\r\n   */\r\n  public readonly packageJson: INodePackageJson | undefined;\r\n\r\n  /**\r\n   * The absolute path of the folder containing the package.json file for the working package, or undefined\r\n   * if API Extractor was invoked without a package.json file.\r\n   */\r\n  public readonly packageFolder: string | undefined;\r\n\r\n  /** {@inheritDoc IConfigFile.mainEntryPointFilePath} */\r\n  public readonly mainEntryPointFilePath: string;\r\n\r\n  /** {@inheritDoc IConfigFile.bundledPackages} */\r\n  public readonly bundledPackages: string[];\r\n\r\n  /** {@inheritDoc IConfigCompiler.tsconfigFilePath} */\r\n  public readonly tsconfigFilePath: string;\r\n\r\n  /** {@inheritDoc IConfigCompiler.overrideTsconfig} */\r\n  public readonly overrideTsconfig: {} | undefined;\r\n\r\n  /** {@inheritDoc IConfigCompiler.skipLibCheck} */\r\n  public readonly skipLibCheck: boolean;\r\n\r\n  /** {@inheritDoc IConfigApiReport.enabled} */\r\n  public readonly apiReportEnabled: boolean;\r\n\r\n  /** The `reportFolder` path combined with the `reportFileName`. */\r\n  public readonly reportFilePath: string;\r\n  /** The `reportTempFolder` path combined with the `reportFileName`. */\r\n  public readonly reportTempFilePath: string;\r\n\r\n  /** {@inheritDoc IConfigDocModel.enabled} */\r\n  public readonly docModelEnabled: boolean;\r\n  /** {@inheritDoc IConfigDocModel.apiJsonFilePath} */\r\n  public readonly apiJsonFilePath: string;\r\n\r\n  /** {@inheritDoc IConfigDtsRollup.enabled} */\r\n  public readonly rollupEnabled: boolean;\r\n  /** {@inheritDoc IConfigDtsRollup.untrimmedFilePath} */\r\n  public readonly untrimmedFilePath: string;\r\n  /** {@inheritDoc IConfigDtsRollup.betaTrimmedFilePath} */\r\n  public readonly betaTrimmedFilePath: string;\r\n  /** {@inheritDoc IConfigDtsRollup.publicTrimmedFilePath} */\r\n  public readonly publicTrimmedFilePath: string;\r\n  /** {@inheritDoc IConfigDtsRollup.omitTrimmingComments} */\r\n  public readonly omitTrimmingComments: boolean;\r\n\r\n  /** {@inheritDoc IConfigTsdocMetadata.enabled} */\r\n  public readonly tsdocMetadataEnabled: boolean;\r\n  /** {@inheritDoc IConfigTsdocMetadata.tsdocMetadataFilePath} */\r\n  public readonly tsdocMetadataFilePath: string;\r\n\r\n  /**\r\n   * The tsdoc.json configuration that will be used when parsing doc comments.\r\n   */\r\n  public readonly tsdocConfigFile: TSDocConfigFile;\r\n\r\n  /**\r\n   * The `TSDocConfiguration` loaded from {@link ExtractorConfig.tsdocConfigFile}.\r\n   */\r\n  public readonly tsdocConfiguration: TSDocConfiguration;\r\n\r\n  /**\r\n   * Specifies what type of newlines API Extractor should use when writing output files.  By default, the output files\r\n   * will be written with Windows-style newlines.\r\n   */\r\n  public readonly newlineKind: NewlineKind;\r\n\r\n  /** {@inheritDoc IConfigFile.messages} */\r\n  public readonly messages: IExtractorMessagesConfig;\r\n\r\n  /** {@inheritDoc IConfigFile.testMode} */\r\n  public readonly testMode: boolean;\r\n\r\n  private constructor(parameters: IExtractorConfigParameters) {\r\n    this.projectFolder = parameters.projectFolder;\r\n    this.packageJson = parameters.packageJson;\r\n    this.packageFolder = parameters.packageFolder;\r\n    this.mainEntryPointFilePath = parameters.mainEntryPointFilePath;\r\n    this.bundledPackages = parameters.bundledPackages;\r\n    this.tsconfigFilePath = parameters.tsconfigFilePath;\r\n    this.overrideTsconfig = parameters.overrideTsconfig;\r\n    this.skipLibCheck = parameters.skipLibCheck;\r\n    this.apiReportEnabled = parameters.apiReportEnabled;\r\n    this.reportFilePath = parameters.reportFilePath;\r\n    this.reportTempFilePath = parameters.reportTempFilePath;\r\n    this.docModelEnabled = parameters.docModelEnabled;\r\n    this.apiJsonFilePath = parameters.apiJsonFilePath;\r\n    this.rollupEnabled = parameters.rollupEnabled;\r\n    this.untrimmedFilePath = parameters.untrimmedFilePath;\r\n    this.betaTrimmedFilePath = parameters.betaTrimmedFilePath;\r\n    this.publicTrimmedFilePath = parameters.publicTrimmedFilePath;\r\n    this.omitTrimmingComments = parameters.omitTrimmingComments;\r\n    this.tsdocMetadataEnabled = parameters.tsdocMetadataEnabled;\r\n    this.tsdocMetadataFilePath = parameters.tsdocMetadataFilePath;\r\n    this.tsdocConfigFile = parameters.tsdocConfigFile;\r\n    this.tsdocConfiguration = parameters.tsdocConfiguration;\r\n    this.newlineKind = parameters.newlineKind;\r\n    this.messages = parameters.messages;\r\n    this.testMode = parameters.testMode;\r\n  }\r\n\r\n  /**\r\n   * Returns a JSON-like string representing the `ExtractorConfig` state, which can be printed to a console\r\n   * for diagnostic purposes.\r\n   *\r\n   * @remarks\r\n   * This is used by the \"--diagnostics\" command-line option.  The string is not intended to be deserialized;\r\n   * its format may be changed at any time.\r\n   */\r\n  public getDiagnosticDump(): string {\r\n    // Handle the simple JSON-serializable properties using buildJsonDumpObject()\r\n    const result: object = MessageRouter.buildJsonDumpObject(this, {\r\n      keyNamesToOmit: ['tsdocConfigFile', 'tsdocConfiguration']\r\n    });\r\n\r\n    // Implement custom formatting for tsdocConfigFile and tsdocConfiguration\r\n\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n    (result as any).tsdocConfigFile = {\r\n      filePath: this.tsdocConfigFile.filePath,\r\n      log: this.tsdocConfigFile.log.messages.map((x) => x.toString())\r\n    };\r\n\r\n    return JSON.stringify(result, undefined, 2);\r\n  }\r\n\r\n  /**\r\n   * Returns a simplified file path for use in error messages.\r\n   * @internal\r\n   */\r\n  public _getShortFilePath(absolutePath: string): string {\r\n    if (!path.isAbsolute(absolutePath)) {\r\n      throw new InternalError('Expected absolute path: ' + absolutePath);\r\n    }\r\n    if (Path.isUnderOrEqual(absolutePath, this.projectFolder)) {\r\n      return Path.convertToSlashes(path.relative(this.projectFolder, absolutePath));\r\n    }\r\n    return absolutePath;\r\n  }\r\n\r\n  /**\r\n   * Searches for the api-extractor.json config file associated with the specified starting folder,\r\n   * and loads the file if found.  This lookup supports\r\n   * {@link https://www.npmjs.com/package/@rushstack/rig-package | rig packages}.\r\n   *\r\n   * @remarks\r\n   * The search will first look for a package.json file in a parent folder of the starting folder;\r\n   * if found, that will be used as the base folder instead of the starting folder.  If the config\r\n   * file is not found in `<baseFolder>/api-extractor.json` or `<baseFolder>/config/api-extractor.json`,\r\n   * then `<baseFolder/config/rig.json` will be checked to see whether a\r\n   * {@link https://www.npmjs.com/package/@rushstack/rig-package | rig package} is referenced; if so then\r\n   * the rig's api-extractor.json file will be used instead.  If a config file is found, it will be loaded\r\n   * and returned with the `IExtractorConfigPrepareOptions` object. Otherwise, `undefined` is returned\r\n   * to indicate that API Extractor does not appear to be configured for the specified folder.\r\n   *\r\n   * @returns An options object that can be passed to {@link ExtractorConfig.prepare}, or `undefined`\r\n   * if not api-extractor.json file was found.\r\n   */\r\n  public static tryLoadForFolder(\r\n    options: IExtractorConfigLoadForFolderOptions\r\n  ): IExtractorConfigPrepareOptions | undefined {\r\n    const packageJsonLookup: PackageJsonLookup = options.packageJsonLookup || new PackageJsonLookup();\r\n    const startingFolder: string = options.startingFolder;\r\n\r\n    // Figure out which project we're in and look for the config file at the project root\r\n    const packageJsonFullPath: string | undefined =\r\n      packageJsonLookup.tryGetPackageJsonFilePathFor(startingFolder);\r\n    const packageFolder: string | undefined = packageJsonFullPath\r\n      ? path.dirname(packageJsonFullPath)\r\n      : undefined;\r\n\r\n    // If there is no package, then just use the starting folder\r\n    const baseFolder: string = packageFolder || startingFolder;\r\n\r\n    let projectFolderLookupToken: string | undefined = undefined;\r\n\r\n    // First try the standard \"config\" subfolder:\r\n    let configFilename: string = path.join(baseFolder, 'config', ExtractorConfig.FILENAME);\r\n    if (FileSystem.exists(configFilename)) {\r\n      if (FileSystem.exists(path.join(baseFolder, ExtractorConfig.FILENAME))) {\r\n        throw new Error(`Found conflicting ${ExtractorConfig.FILENAME} files in \".\" and \"./config\" folders`);\r\n      }\r\n    } else {\r\n      // Otherwise try the top-level folder\r\n      configFilename = path.join(baseFolder, ExtractorConfig.FILENAME);\r\n\r\n      if (!FileSystem.exists(configFilename)) {\r\n        // If We didn't find it in <packageFolder>/api-extractor.json or <packageFolder>/config/api-extractor.json\r\n        // then check for a rig package\r\n        if (packageFolder) {\r\n          let rigConfig: RigConfig;\r\n          if (options.rigConfig) {\r\n            // The caller provided an already solved RigConfig.  Double-check that it is for the right project.\r\n            if (!Path.isEqual(options.rigConfig.projectFolderPath, packageFolder)) {\r\n              throw new Error(\r\n                'The provided ILoadForFolderOptions.rigConfig is for the wrong project folder:\\n' +\r\n                  '\\nExpected path: ' +\r\n                  packageFolder +\r\n                  '\\nProvided path: ' +\r\n                  options.rigConfig.projectFolderOriginalPath\r\n              );\r\n            }\r\n            rigConfig = options.rigConfig;\r\n          } else {\r\n            rigConfig = RigConfig.loadForProjectFolder({\r\n              projectFolderPath: packageFolder\r\n            });\r\n          }\r\n\r\n          if (rigConfig.rigFound) {\r\n            configFilename = path.join(rigConfig.getResolvedProfileFolder(), ExtractorConfig.FILENAME);\r\n\r\n            // If the \"projectFolder\" setting isn't specified in api-extractor.json, it defaults to the\r\n            // \"<lookup>\" token which will probe for the tsconfig.json nearest to the api-extractor.json path.\r\n            // But this won't work if api-extractor.json belongs to the rig.  So instead \"<lookup>\" should be\r\n            // the \"<packageFolder>\" that referenced the rig.\r\n            projectFolderLookupToken = packageFolder;\r\n          }\r\n        }\r\n        if (!FileSystem.exists(configFilename)) {\r\n          // API Extractor does not seem to be configured for this folder\r\n          return undefined;\r\n        }\r\n      }\r\n    }\r\n\r\n    const configObjectFullPath: string = path.resolve(configFilename);\r\n    const configObject: IConfigFile = ExtractorConfig.loadFile(configObjectFullPath);\r\n\r\n    return {\r\n      configObject,\r\n      configObjectFullPath,\r\n      packageJsonFullPath,\r\n      projectFolderLookupToken\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Loads the api-extractor.json config file from the specified file path, and prepares an `ExtractorConfig` object.\r\n   *\r\n   * @remarks\r\n   * Loads the api-extractor.json config file from the specified file path.   If the \"extends\" field is present,\r\n   * the referenced file(s) will be merged.  For any omitted fields, the API Extractor default values are merged.\r\n   *\r\n   * The result is prepared using `ExtractorConfig.prepare()`.\r\n   */\r\n  public static loadFileAndPrepare(configJsonFilePath: string): ExtractorConfig {\r\n    const configObjectFullPath: string = path.resolve(configJsonFilePath);\r\n    const configObject: IConfigFile = ExtractorConfig.loadFile(configObjectFullPath);\r\n\r\n    const packageJsonLookup: PackageJsonLookup = new PackageJsonLookup();\r\n    const packageJsonFullPath: string | undefined =\r\n      packageJsonLookup.tryGetPackageJsonFilePathFor(configObjectFullPath);\r\n\r\n    const extractorConfig: ExtractorConfig = ExtractorConfig.prepare({\r\n      configObject,\r\n      configObjectFullPath,\r\n      packageJsonFullPath\r\n    });\r\n\r\n    return extractorConfig;\r\n  }\r\n\r\n  /**\r\n   * Performs only the first half of {@link ExtractorConfig.loadFileAndPrepare}, providing an opportunity to\r\n   * modify the object before it is passed to {@link ExtractorConfig.prepare}.\r\n   *\r\n   * @remarks\r\n   * Loads the api-extractor.json config file from the specified file path.   If the \"extends\" field is present,\r\n   * the referenced file(s) will be merged.  For any omitted fields, the API Extractor default values are merged.\r\n   */\r\n  public static loadFile(jsonFilePath: string): IConfigFile {\r\n    // Set to keep track of config files which have been processed.\r\n    const visitedPaths: Set<string> = new Set<string>();\r\n\r\n    let currentConfigFilePath: string = path.resolve(jsonFilePath);\r\n    let configObject: Partial<IConfigFile> = {};\r\n\r\n    try {\r\n      do {\r\n        // Check if this file was already processed.\r\n        if (visitedPaths.has(currentConfigFilePath)) {\r\n          throw new Error(\r\n            `The API Extractor \"extends\" setting contains a cycle.` +\r\n              `  This file is included twice: \"${currentConfigFilePath}\"`\r\n          );\r\n        }\r\n        visitedPaths.add(currentConfigFilePath);\r\n\r\n        const currentConfigFolderPath: string = path.dirname(currentConfigFilePath);\r\n\r\n        // Load the extractor config defined in extends property.\r\n        const baseConfig: IConfigFile = JsonFile.load(currentConfigFilePath);\r\n\r\n        let extendsField: string = baseConfig.extends || '';\r\n\r\n        // Delete the \"extends\" field so it doesn't get merged\r\n        delete baseConfig.extends;\r\n\r\n        if (extendsField) {\r\n          if (extendsField.match(/^\\.\\.?[\\\\/]/)) {\r\n            // EXAMPLE:  \"./subfolder/api-extractor-base.json\"\r\n            extendsField = path.resolve(currentConfigFolderPath, extendsField);\r\n          } else {\r\n            // EXAMPLE:  \"my-package/api-extractor-base.json\"\r\n            //\r\n            // Resolve \"my-package\" from the perspective of the current folder.\r\n            try {\r\n              extendsField = resolve.sync(extendsField, {\r\n                basedir: currentConfigFolderPath\r\n              });\r\n            } catch (e) {\r\n              throw new Error(`Error resolving NodeJS path \"${extendsField}\": ${e.message}`);\r\n            }\r\n          }\r\n        }\r\n\r\n        // This step has to be performed in advance, since the currentConfigFolderPath information will be lost\r\n        // after lodash.merge() is performed.\r\n        ExtractorConfig._resolveConfigFileRelativePaths(baseConfig, currentConfigFolderPath);\r\n\r\n        // Merge extractorConfig into baseConfig, mutating baseConfig\r\n        lodash.merge(baseConfig, configObject);\r\n        configObject = baseConfig;\r\n\r\n        currentConfigFilePath = extendsField;\r\n      } while (currentConfigFilePath);\r\n    } catch (e) {\r\n      throw new Error(`Error loading ${currentConfigFilePath}:\\n` + e.message);\r\n    }\r\n\r\n    // Lastly, apply the defaults\r\n    configObject = lodash.merge(lodash.cloneDeep(ExtractorConfig._defaultConfig), configObject);\r\n\r\n    ExtractorConfig.jsonSchema.validateObject(configObject, jsonFilePath);\r\n\r\n    // The schema validation should ensure that this object conforms to IConfigFile\r\n    return configObject as IConfigFile;\r\n  }\r\n\r\n  private static _resolveConfigFileRelativePaths(\r\n    configFile: IConfigFile,\r\n    currentConfigFolderPath: string\r\n  ): void {\r\n    if (configFile.projectFolder) {\r\n      configFile.projectFolder = ExtractorConfig._resolveConfigFileRelativePath(\r\n        'projectFolder',\r\n        configFile.projectFolder,\r\n        currentConfigFolderPath\r\n      );\r\n    }\r\n\r\n    if (configFile.mainEntryPointFilePath) {\r\n      configFile.mainEntryPointFilePath = ExtractorConfig._resolveConfigFileRelativePath(\r\n        'mainEntryPointFilePath',\r\n        configFile.mainEntryPointFilePath,\r\n        currentConfigFolderPath\r\n      );\r\n    }\r\n\r\n    if (configFile.compiler) {\r\n      if (configFile.compiler.tsconfigFilePath) {\r\n        configFile.compiler.tsconfigFilePath = ExtractorConfig._resolveConfigFileRelativePath(\r\n          'tsconfigFilePath',\r\n          configFile.compiler.tsconfigFilePath,\r\n          currentConfigFolderPath\r\n        );\r\n      }\r\n    }\r\n\r\n    if (configFile.apiReport) {\r\n      if (configFile.apiReport.reportFolder) {\r\n        configFile.apiReport.reportFolder = ExtractorConfig._resolveConfigFileRelativePath(\r\n          'reportFolder',\r\n          configFile.apiReport.reportFolder,\r\n          currentConfigFolderPath\r\n        );\r\n      }\r\n      if (configFile.apiReport.reportTempFolder) {\r\n        configFile.apiReport.reportTempFolder = ExtractorConfig._resolveConfigFileRelativePath(\r\n          'reportTempFolder',\r\n          configFile.apiReport.reportTempFolder,\r\n          currentConfigFolderPath\r\n        );\r\n      }\r\n    }\r\n\r\n    if (configFile.docModel) {\r\n      if (configFile.docModel.apiJsonFilePath) {\r\n        configFile.docModel.apiJsonFilePath = ExtractorConfig._resolveConfigFileRelativePath(\r\n          'apiJsonFilePath',\r\n          configFile.docModel.apiJsonFilePath,\r\n          currentConfigFolderPath\r\n        );\r\n      }\r\n    }\r\n\r\n    if (configFile.dtsRollup) {\r\n      if (configFile.dtsRollup.untrimmedFilePath) {\r\n        configFile.dtsRollup.untrimmedFilePath = ExtractorConfig._resolveConfigFileRelativePath(\r\n          'untrimmedFilePath',\r\n          configFile.dtsRollup.untrimmedFilePath,\r\n          currentConfigFolderPath\r\n        );\r\n      }\r\n      if (configFile.dtsRollup.betaTrimmedFilePath) {\r\n        configFile.dtsRollup.betaTrimmedFilePath = ExtractorConfig._resolveConfigFileRelativePath(\r\n          'betaTrimmedFilePath',\r\n          configFile.dtsRollup.betaTrimmedFilePath,\r\n          currentConfigFolderPath\r\n        );\r\n      }\r\n      if (configFile.dtsRollup.publicTrimmedFilePath) {\r\n        configFile.dtsRollup.publicTrimmedFilePath = ExtractorConfig._resolveConfigFileRelativePath(\r\n          'publicTrimmedFilePath',\r\n          configFile.dtsRollup.publicTrimmedFilePath,\r\n          currentConfigFolderPath\r\n        );\r\n      }\r\n    }\r\n\r\n    if (configFile.tsdocMetadata) {\r\n      if (configFile.tsdocMetadata.tsdocMetadataFilePath) {\r\n        configFile.tsdocMetadata.tsdocMetadataFilePath = ExtractorConfig._resolveConfigFileRelativePath(\r\n          'tsdocMetadataFilePath',\r\n          configFile.tsdocMetadata.tsdocMetadataFilePath,\r\n          currentConfigFolderPath\r\n        );\r\n      }\r\n    }\r\n  }\r\n\r\n  private static _resolveConfigFileRelativePath(\r\n    fieldName: string,\r\n    fieldValue: string,\r\n    currentConfigFolderPath: string\r\n  ): string {\r\n    if (!path.isAbsolute(fieldValue)) {\r\n      if (fieldValue.indexOf('<projectFolder>') !== 0) {\r\n        // If the path is not absolute and does not start with \"<projectFolder>\", then resolve it relative\r\n        // to the folder of the config file that it appears in\r\n        return path.join(currentConfigFolderPath, fieldValue);\r\n      }\r\n    }\r\n\r\n    return fieldValue;\r\n  }\r\n\r\n  /**\r\n   * Prepares an `ExtractorConfig` object using a configuration that is provided as a runtime object,\r\n   * rather than reading it from disk.  This allows configurations to be constructed programmatically,\r\n   * loaded from an alternate source, and/or customized after loading.\r\n   */\r\n  public static prepare(options: IExtractorConfigPrepareOptions): ExtractorConfig {\r\n    const filenameForErrors: string = options.configObjectFullPath || 'the configuration object';\r\n    const configObject: Partial<IConfigFile> = options.configObject;\r\n\r\n    if (configObject.extends) {\r\n      throw new Error(\r\n        'The IConfigFile.extends field must be expanded before calling ExtractorConfig.prepare()'\r\n      );\r\n    }\r\n\r\n    if (options.configObjectFullPath) {\r\n      if (!path.isAbsolute(options.configObjectFullPath)) {\r\n        throw new Error('The \"configObjectFullPath\" setting must be an absolute path');\r\n      }\r\n    }\r\n\r\n    ExtractorConfig.jsonSchema.validateObject(configObject, filenameForErrors);\r\n\r\n    const packageJsonFullPath: string | undefined = options.packageJsonFullPath;\r\n    let packageFolder: string | undefined = undefined;\r\n    let packageJson: INodePackageJson | undefined = undefined;\r\n\r\n    if (packageJsonFullPath) {\r\n      if (!/.json$/i.test(packageJsonFullPath)) {\r\n        // Catch common mistakes e.g. where someone passes a folder path instead of a file path\r\n        throw new Error('The \"packageJsonFullPath\" setting does not have a .json file extension');\r\n      }\r\n      if (!path.isAbsolute(packageJsonFullPath)) {\r\n        throw new Error('The \"packageJsonFullPath\" setting must be an absolute path');\r\n      }\r\n\r\n      if (options.packageJson) {\r\n        packageJson = options.packageJson;\r\n      } else {\r\n        const packageJsonLookup: PackageJsonLookup = new PackageJsonLookup();\r\n        packageJson = packageJsonLookup.loadNodePackageJson(packageJsonFullPath);\r\n      }\r\n\r\n      packageFolder = path.dirname(packageJsonFullPath);\r\n    }\r\n\r\n    // \"tsdocConfigFile\" and \"tsdocConfiguration\" are prepared outside the try-catch block,\r\n    // so that if exceptions are thrown, it will not get the \"Error parsing api-extractor.json:\" header\r\n    let extractorConfigParameters: Omit<IExtractorConfigParameters, 'tsdocConfigFile' | 'tsdocConfiguration'>;\r\n\r\n    try {\r\n      if (!configObject.compiler) {\r\n        // A merged configuration should have this\r\n        throw new Error('The \"compiler\" section is missing');\r\n      }\r\n\r\n      if (!configObject.projectFolder) {\r\n        // A merged configuration should have this\r\n        throw new Error('The \"projectFolder\" setting is missing');\r\n      }\r\n\r\n      let projectFolder: string;\r\n      if (configObject.projectFolder.trim() === '<lookup>') {\r\n        if (options.projectFolderLookupToken) {\r\n          // Use the manually specified \"<lookup>\" value\r\n          projectFolder = options.projectFolderLookupToken;\r\n\r\n          if (!FileSystem.exists(options.projectFolderLookupToken)) {\r\n            throw new Error(\r\n              'The specified \"projectFolderLookupToken\" path does not exist: ' +\r\n                options.projectFolderLookupToken\r\n            );\r\n          }\r\n        } else {\r\n          if (!options.configObjectFullPath) {\r\n            throw new Error(\r\n              'The \"projectFolder\" setting uses the \"<lookup>\" token, but it cannot be expanded because' +\r\n                ' the \"configObjectFullPath\" setting was not specified'\r\n            );\r\n          }\r\n\r\n          // \"The default value for `projectFolder` is the token `<lookup>`, which means the folder is determined\r\n          // by traversing parent folders, starting from the folder containing api-extractor.json, and stopping\r\n          // at the first folder that contains a tsconfig.json file.  If a tsconfig.json file cannot be found in\r\n          // this way, then an error will be reported.\"\r\n\r\n          let currentFolder: string = path.dirname(options.configObjectFullPath);\r\n          for (;;) {\r\n            const tsconfigPath: string = path.join(currentFolder, 'tsconfig.json');\r\n            if (FileSystem.exists(tsconfigPath)) {\r\n              projectFolder = currentFolder;\r\n              break;\r\n            }\r\n            const parentFolder: string = path.dirname(currentFolder);\r\n            if (parentFolder === '' || parentFolder === currentFolder) {\r\n              throw new Error(\r\n                'The \"projectFolder\" setting uses the \"<lookup>\" token, but a tsconfig.json file cannot be' +\r\n                  ' found in this folder or any parent folder.'\r\n              );\r\n            }\r\n            currentFolder = parentFolder;\r\n          }\r\n        }\r\n      } else {\r\n        ExtractorConfig._rejectAnyTokensInPath(configObject.projectFolder, 'projectFolder');\r\n\r\n        if (!FileSystem.exists(configObject.projectFolder)) {\r\n          throw new Error('The specified \"projectFolder\" path does not exist: ' + configObject.projectFolder);\r\n        }\r\n\r\n        projectFolder = configObject.projectFolder;\r\n      }\r\n\r\n      const tokenContext: IExtractorConfigTokenContext = {\r\n        unscopedPackageName: 'unknown-package',\r\n        packageName: 'unknown-package',\r\n        projectFolder: projectFolder\r\n      };\r\n\r\n      if (packageJson) {\r\n        tokenContext.packageName = packageJson.name;\r\n        tokenContext.unscopedPackageName = PackageName.getUnscopedName(packageJson.name);\r\n      }\r\n\r\n      if (!configObject.mainEntryPointFilePath) {\r\n        // A merged configuration should have this\r\n        throw new Error('The \"mainEntryPointFilePath\" setting is missing');\r\n      }\r\n      const mainEntryPointFilePath: string = ExtractorConfig._resolvePathWithTokens(\r\n        'mainEntryPointFilePath',\r\n        configObject.mainEntryPointFilePath,\r\n        tokenContext\r\n      );\r\n\r\n      if (!ExtractorConfig.hasDtsFileExtension(mainEntryPointFilePath)) {\r\n        throw new Error(\r\n          'The \"mainEntryPointFilePath\" value is not a declaration file: ' + mainEntryPointFilePath\r\n        );\r\n      }\r\n\r\n      if (!FileSystem.exists(mainEntryPointFilePath)) {\r\n        throw new Error('The \"mainEntryPointFilePath\" path does not exist: ' + mainEntryPointFilePath);\r\n      }\r\n\r\n      const bundledPackages: string[] = configObject.bundledPackages || [];\r\n      for (const bundledPackage of bundledPackages) {\r\n        if (!PackageName.isValidName(bundledPackage)) {\r\n          throw new Error(`The \"bundledPackages\" list contains an invalid package name: \"${bundledPackage}\"`);\r\n        }\r\n      }\r\n\r\n      const tsconfigFilePath: string = ExtractorConfig._resolvePathWithTokens(\r\n        'tsconfigFilePath',\r\n        configObject.compiler.tsconfigFilePath,\r\n        tokenContext\r\n      );\r\n\r\n      if (configObject.compiler.overrideTsconfig === undefined) {\r\n        if (!tsconfigFilePath) {\r\n          throw new Error('Either the \"tsconfigFilePath\" or \"overrideTsconfig\" setting must be specified');\r\n        }\r\n        if (!FileSystem.exists(tsconfigFilePath)) {\r\n          throw new Error('The file referenced by \"tsconfigFilePath\" does not exist: ' + tsconfigFilePath);\r\n        }\r\n      }\r\n\r\n      let apiReportEnabled: boolean = false;\r\n      let reportFilePath: string = '';\r\n      let reportTempFilePath: string = '';\r\n      if (configObject.apiReport) {\r\n        apiReportEnabled = !!configObject.apiReport.enabled;\r\n\r\n        const reportFilename: string = ExtractorConfig._expandStringWithTokens(\r\n          'reportFileName',\r\n          configObject.apiReport.reportFileName || '',\r\n          tokenContext\r\n        );\r\n\r\n        if (!reportFilename) {\r\n          // A merged configuration should have this\r\n          throw new Error('The \"reportFilename\" setting is missing');\r\n        }\r\n        if (reportFilename.indexOf('/') >= 0 || reportFilename.indexOf('\\\\') >= 0) {\r\n          // A merged configuration should have this\r\n          throw new Error(`The \"reportFilename\" setting contains invalid characters: \"${reportFilename}\"`);\r\n        }\r\n\r\n        const reportFolder: string = ExtractorConfig._resolvePathWithTokens(\r\n          'reportFolder',\r\n          configObject.apiReport.reportFolder,\r\n          tokenContext\r\n        );\r\n        const reportTempFolder: string = ExtractorConfig._resolvePathWithTokens(\r\n          'reportTempFolder',\r\n          configObject.apiReport.reportTempFolder,\r\n          tokenContext\r\n        );\r\n\r\n        reportFilePath = path.join(reportFolder, reportFilename);\r\n        reportTempFilePath = path.join(reportTempFolder, reportFilename);\r\n      }\r\n\r\n      let docModelEnabled: boolean = false;\r\n      let apiJsonFilePath: string = '';\r\n      if (configObject.docModel) {\r\n        docModelEnabled = !!configObject.docModel.enabled;\r\n        apiJsonFilePath = ExtractorConfig._resolvePathWithTokens(\r\n          'apiJsonFilePath',\r\n          configObject.docModel.apiJsonFilePath,\r\n          tokenContext\r\n        );\r\n      }\r\n\r\n      let tsdocMetadataEnabled: boolean = false;\r\n      let tsdocMetadataFilePath: string = '';\r\n      if (configObject.tsdocMetadata) {\r\n        tsdocMetadataEnabled = !!configObject.tsdocMetadata.enabled;\r\n\r\n        if (tsdocMetadataEnabled) {\r\n          tsdocMetadataFilePath = configObject.tsdocMetadata.tsdocMetadataFilePath || '';\r\n\r\n          if (tsdocMetadataFilePath.trim() === '<lookup>') {\r\n            if (!packageJson) {\r\n              throw new Error(\r\n                'The \"<lookup>\" token cannot be used with the \"tsdocMetadataFilePath\" setting because' +\r\n                  ' the \"packageJson\" option was not provided'\r\n              );\r\n            }\r\n            if (!packageJsonFullPath) {\r\n              throw new Error(\r\n                'The \"<lookup>\" token cannot be used with \"tsdocMetadataFilePath\" because' +\r\n                  'the \"packageJsonFullPath\" option was not provided'\r\n              );\r\n            }\r\n            tsdocMetadataFilePath = PackageMetadataManager.resolveTsdocMetadataPath(\r\n              path.dirname(packageJsonFullPath),\r\n              packageJson\r\n            );\r\n          } else {\r\n            tsdocMetadataFilePath = ExtractorConfig._resolvePathWithTokens(\r\n              'tsdocMetadataFilePath',\r\n              configObject.tsdocMetadata.tsdocMetadataFilePath,\r\n              tokenContext\r\n            );\r\n          }\r\n\r\n          if (!tsdocMetadataFilePath) {\r\n            throw new Error(\r\n              'The \"tsdocMetadata.enabled\" setting is enabled,' +\r\n                ' but \"tsdocMetadataFilePath\" is not specified'\r\n            );\r\n          }\r\n        }\r\n      }\r\n\r\n      let rollupEnabled: boolean = false;\r\n      let untrimmedFilePath: string = '';\r\n      let betaTrimmedFilePath: string = '';\r\n      let publicTrimmedFilePath: string = '';\r\n      let omitTrimmingComments: boolean = false;\r\n\r\n      if (configObject.dtsRollup) {\r\n        rollupEnabled = !!configObject.dtsRollup.enabled;\r\n        untrimmedFilePath = ExtractorConfig._resolvePathWithTokens(\r\n          'untrimmedFilePath',\r\n          configObject.dtsRollup.untrimmedFilePath,\r\n          tokenContext\r\n        );\r\n        betaTrimmedFilePath = ExtractorConfig._resolvePathWithTokens(\r\n          'betaTrimmedFilePath',\r\n          configObject.dtsRollup.betaTrimmedFilePath,\r\n          tokenContext\r\n        );\r\n        publicTrimmedFilePath = ExtractorConfig._resolvePathWithTokens(\r\n          'publicTrimmedFilePath',\r\n          configObject.dtsRollup.publicTrimmedFilePath,\r\n          tokenContext\r\n        );\r\n        omitTrimmingComments = !!configObject.dtsRollup.omitTrimmingComments;\r\n      }\r\n\r\n      let newlineKind: NewlineKind;\r\n      switch (configObject.newlineKind) {\r\n        case 'lf':\r\n          newlineKind = NewlineKind.Lf;\r\n          break;\r\n        case 'os':\r\n          newlineKind = NewlineKind.OsDefault;\r\n          break;\r\n        default:\r\n          newlineKind = NewlineKind.CrLf;\r\n          break;\r\n      }\r\n      extractorConfigParameters = {\r\n        projectFolder: projectFolder,\r\n        packageJson,\r\n        packageFolder,\r\n        mainEntryPointFilePath,\r\n        bundledPackages,\r\n        tsconfigFilePath,\r\n        overrideTsconfig: configObject.compiler.overrideTsconfig,\r\n        skipLibCheck: !!configObject.compiler.skipLibCheck,\r\n        apiReportEnabled,\r\n        reportFilePath,\r\n        reportTempFilePath,\r\n        docModelEnabled,\r\n        apiJsonFilePath,\r\n        rollupEnabled,\r\n        untrimmedFilePath,\r\n        betaTrimmedFilePath,\r\n        publicTrimmedFilePath,\r\n        omitTrimmingComments,\r\n        tsdocMetadataEnabled,\r\n        tsdocMetadataFilePath,\r\n        newlineKind,\r\n        messages: configObject.messages || {},\r\n        testMode: !!configObject.testMode\r\n      };\r\n    } catch (e) {\r\n      throw new Error(`Error parsing ${filenameForErrors}:\\n` + e.message);\r\n    }\r\n\r\n    let tsdocConfigFile: TSDocConfigFile | undefined = options.tsdocConfigFile;\r\n\r\n    if (!tsdocConfigFile) {\r\n      // Example: \"my-project/tsdoc.json\"\r\n      let packageTSDocConfigPath: string = TSDocConfigFile.findConfigPathForFolder(\r\n        extractorConfigParameters.projectFolder\r\n      );\r\n\r\n      if (!packageTSDocConfigPath || !FileSystem.exists(packageTSDocConfigPath)) {\r\n        // If the project does not have a tsdoc.json config file, then use API Extractor's base file.\r\n        packageTSDocConfigPath = ExtractorConfig._tsdocBaseFilePath;\r\n        if (!FileSystem.exists(packageTSDocConfigPath)) {\r\n          throw new InternalError('Unable to load the built-in TSDoc config file: ' + packageTSDocConfigPath);\r\n        }\r\n      }\r\n      tsdocConfigFile = TSDocConfigFile.loadFile(packageTSDocConfigPath);\r\n    }\r\n\r\n    // IMPORTANT: After calling TSDocConfigFile.loadFile(), we need to check for errors.\r\n    if (tsdocConfigFile.hasErrors) {\r\n      throw new Error(tsdocConfigFile.getErrorSummary());\r\n    }\r\n\r\n    const tsdocConfiguration: TSDocConfiguration = new TSDocConfiguration();\r\n    tsdocConfigFile.configureParser(tsdocConfiguration);\r\n\r\n    // IMPORTANT: After calling TSDocConfigFile.configureParser(), we need to check for errors a second time.\r\n    if (tsdocConfigFile.hasErrors) {\r\n      throw new Error(tsdocConfigFile.getErrorSummary());\r\n    }\r\n\r\n    return new ExtractorConfig({ ...extractorConfigParameters, tsdocConfigFile, tsdocConfiguration });\r\n  }\r\n\r\n  private static _resolvePathWithTokens(\r\n    fieldName: string,\r\n    value: string | undefined,\r\n    tokenContext: IExtractorConfigTokenContext\r\n  ): string {\r\n    value = ExtractorConfig._expandStringWithTokens(fieldName, value, tokenContext);\r\n    if (value !== '') {\r\n      value = path.resolve(tokenContext.projectFolder, value);\r\n    }\r\n    return value;\r\n  }\r\n\r\n  private static _expandStringWithTokens(\r\n    fieldName: string,\r\n    value: string | undefined,\r\n    tokenContext: IExtractorConfigTokenContext\r\n  ): string {\r\n    value = value ? value.trim() : '';\r\n    if (value !== '') {\r\n      value = Text.replaceAll(value, '<unscopedPackageName>', tokenContext.unscopedPackageName);\r\n      value = Text.replaceAll(value, '<packageName>', tokenContext.packageName);\r\n\r\n      const projectFolderToken: string = '<projectFolder>';\r\n      if (value.indexOf(projectFolderToken) === 0) {\r\n        // Replace \"<projectFolder>\" at the start of a string\r\n        value = path.join(tokenContext.projectFolder, value.substr(projectFolderToken.length));\r\n      }\r\n\r\n      if (value.indexOf(projectFolderToken) >= 0) {\r\n        // If after all replacements, \"<projectFolder>\" appears somewhere in the string, report an error\r\n        throw new Error(\r\n          `The \"${fieldName}\" value incorrectly uses the \"<projectFolder>\" token.` +\r\n            ` It must appear at the start of the string.`\r\n        );\r\n      }\r\n\r\n      if (value.indexOf('<lookup>') >= 0) {\r\n        throw new Error(`The \"${fieldName}\" value incorrectly uses the \"<lookup>\" token`);\r\n      }\r\n      ExtractorConfig._rejectAnyTokensInPath(value, fieldName);\r\n    }\r\n    return value;\r\n  }\r\n\r\n  /**\r\n   * Returns true if the specified file path has the \".d.ts\" file extension.\r\n   */\r\n  public static hasDtsFileExtension(filePath: string): boolean {\r\n    return ExtractorConfig._declarationFileExtensionRegExp.test(filePath);\r\n  }\r\n\r\n  /**\r\n   * Given a path string that may have originally contained expandable tokens such as `<projectFolder>\"`\r\n   * this reports an error if any token-looking substrings remain after expansion (e.g. `c:\\blah\\<invalid>\\blah`).\r\n   */\r\n  private static _rejectAnyTokensInPath(value: string, fieldName: string): void {\r\n    if (value.indexOf('<') < 0 && value.indexOf('>') < 0) {\r\n      return;\r\n    }\r\n\r\n    // Can we determine the name of a token?\r\n    const tokenRegExp: RegExp = /(\\<[^<]*?\\>)/;\r\n    const match: RegExpExecArray | null = tokenRegExp.exec(value);\r\n    if (match) {\r\n      throw new Error(`The \"${fieldName}\" value contains an unrecognized token \"${match[1]}\"`);\r\n    }\r\n    throw new Error(`The \"${fieldName}\" value contains extra token characters (\"<\" or \">\"): ${value}`);\r\n  }\r\n}\r\n"]}