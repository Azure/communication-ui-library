import { Canvas, Meta, ArgTypes, Source } from '@storybook/blocks';
import * as MessageThreadStories from './index.stories';

import DefaultMessageThreadExampleText from '!!raw-loader!./snippets/Default.snippet.tsx';
import ExampleImportantsText from '!!raw-loader!./snippets/placeholdermessages.ts';

<Meta of={MessageThreadStories} />

# MessageThread

MessageThread allows you to easily create a component for rendering chat messages, handling scrolling behavior of new/old messages and customizing icons & controls inside the chat thread.

MessageThread internally uses the `Chat` & `ChatMessage` components from `@fluentui-contrib/chat`. You can
checkout the details about these components
[here](https://microsoft.github.io/fluentui-contrib/react-chat/?path=/story/chat--default).

The MessageThread component supports lazy loading for the rich text editor used for editing messages. This means
that the rich text editor and its dependencies can be excluded from the bundle if they're not required,
utilizing tree-shaking techniques such as [the sideEffects
option](https://webpack.js.org/guides/tree-shaking/#mark-the-file-as-side-effect-free) in webpack.

## Importing

```ts
import { FluentThemeProvider, MessageThread } from '@azure/communication-react';
```

## Sample messages

Create a `placeholdermessages.ts` file in the current folder you are working on. Then copy paste the code below
into that file.

<Source code={ExampleImportantsText} />

## Default MessageThread

By default, MessageThread displays Chat messages with display name of only for other users and creation time
of message when available.

<Canvas
  of={MessageThreadStories.DefaultMessageThreadDocsOnly}
  source={{ code: DefaultMessageThreadExampleText }}
  layout="padded"
/>

## Props

<ArgTypes />
