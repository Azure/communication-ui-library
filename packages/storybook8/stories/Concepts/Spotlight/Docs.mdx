import { Meta, Source } from '@storybook/addon-docs';

import CustomSpotlightCompositeText from '!!raw-loader!./snippets/CustomSpotlightComposite.snippet.tsx';
import HideSpotlightText from '!!raw-loader!./snippets/HideSpotlight.snippet.tsx';
import SpotlightEventText from '!!raw-loader!./snippets/SpotlightEvent.snippet.tsx';

<Meta title="Concepts/Spotlight" />

# Spotlight

The spotlight feature enables ACS users to add spotlight to one or more participants, including themselves, in a Teams
call when using CallComposite and CallWithChatComposite. This means that ACS users in large groups are able to adjust
focus to certain participants for everyone in the call. The ACS users must have the Organizer, Co-Organizer or
Presenter role to have the capability to use the spotlight feature.

The supported scenarios for the spotlight feature are:

- Teams Interop Meetings
- Teams Interop Meetings as a Teams user
- Teams ad-hoc call

Participants can be spotlighted using the contextual menu button on their video gallery tile like shown below:

<img style={{ width: 'auto', height: 'auto' }} src="images/spotlight/spotlight-menu-in-video-gallery.png" />

Participants can also be spotlighted using the contextual menu button on their participant item in the people pane like
shown below:

<img style={{ width: 'auto', height: 'auto' }} src="images/spotlight/spotlight-menu-in-people-pane.png" />

Spotlighted participants will be placed in the main view of VideoGallery like shown below:

<img style={{ width: 'auto', height: 'auto' }} src="images/spotlight/spotlighted-in-video-gallery.png" />

If screen share is active, then spotlighted participants will be seen first in the overflow gallery like shown below:

<img
  style={{ width: 'auto', height: 'auto' }}
  src="images/spotlight/spotlighted-in-video-gallery-with-screen-share.png"
/>

Spotlighted participants will be first regardless of dominant speakers, pinned participants, or whomever has their
video turned on in the call. The concept of the spotlight feature is the same in Microsoft Teams which you can read
more about
[here](https://support.microsoft.com/en-us/office/spotlight-someone-s-video-in-microsoft-teams-meetings-58be74a4-efac-4e89-a212-8d198182081e).

## Hiding the spotlight buttons

The spotlight feature is available by default in the CallComposite and CallWithChatComposite. If you want to hide the
buttons to start and stop spotlight in the VideoGallery and people pane, you can do so by setting the composite
`options` prop like shown in the following code snippet.

<Source code={HideSpotlightText} />

Note: Setting the composite `options` prop to hide spotlight buttons will only prevent the user from starting and
stopping spotlight. Participants spotlighted by remote participants will still be placed in the main view of
VideoGallery in the CallComposite and CallWithChatComposite.

## Listening to spotlight changes

You can listen to 'spotlightChanged' events on the CallAdapter or CallWithChatAdapter by defining your own
`SpotlightChangedListener` callback. The following code snippet shows an example of listening to 'spotlightChanged'
events on the CallAdapter to log the added and removed participants to the browser console. But you can choose to
do more if you wish.

<Source code={SpotlightEventText} />

Note: Assigning a `SpotlightChangedListener` callback to listen for 'spotlightChanged' events will not override the
behavior of CallComposite and CallWithChatComposite which places spotlighted participants in the main view of
VideoGallery.

## Programatic spotlight

The CallAdapter and CallWithChatAdapter can also be used to programatically spotlight one or more participants using
the functions `startSpotlight` and `stopSpotlight`. The example below shows a code snippet where a button is added
to invoke the `startSpotlight` function to spotlight remote participants from an added dropdown that is populated
by remote participants in the call.

<Source code={CustomSpotlightCompositeText} />
