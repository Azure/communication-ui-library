import { Stack, PrimaryButton } from '@fluentui/react';
import { Meta, Source } from '@storybook/addon-docs';
import { overviewPageImagesStackStyle } from '../../constants';
import {
  exampleDisableCaptions,
  exampleStartCaptionsBackgroundNoUI,
  exampleStartCaptionsBackgroundShowUI
} from './snippets/ClosedCaptions.snippet.tsx';

<Meta title="Concepts/Closed Captions" />

# Closed Captions

Azure Communication Services UI Library is adding support for Closed Captions. Closed captions are a powerful tool that enables developers to enhance the accessibility of their videos. With closed captions, developers can provide a textual representation of the audio content in their videos, making it easier for users who are deaf or hard of hearing to follow along. Here are main scenarios where Closed Captions are useful:

Accessibility: In the workplace or consumer apps, Closed Captioning for meetings, conference calls, and training videos can make a dramatic difference. Scenarios when audio cannot be heard, either because of a noisy environment, such as an airport, or because of an environment that must be kept quiet, such as a hospital.

Inclusivity: Closed Captioning was developed to aid hearing-impaired people but can also be useful in language proficiency as well.

# Incorporating Closed Captions in your experience:

The UI Library helps Contoso become more accessible and inclusive by providing closed captions within the composite and component experiences.

## Interop Closed Captions:

Interop Closed Captions are enabled by default and are automatically included within the CallComposite and CallWithChatComposite experiences.
Captions can be enabled both in Mobile Web sessions and in Desktop Web sessions.
For interop captions, users can enable captions in the menu and select the spoken language for the captions.
Captions does not detect language automatically, so the spoken language selected needs to match the language that will be used in the call.
Translation is also supported in this scenario.

## ACS Based Captions:

ACS Closed Captions are enabled by default and are automatically included within the CallComposite and CallWithChatComposite experiences.
Captions can be enabled both in Mobile Web sessions and in Desktop Web sessions.
Currently, ACS captions does not support changing caption language or translation. Only changing the spoken language is supported at this time.

## Closed Captions using Components

For component users, we export the following components to help you integrate captions in your own calling experiences.

[StartCaptionsButton](./?path=/docs/components-start-captions-button--docs) is a component that can be used to turn on captions. Developers and use 'usePropsFor' to gather all the information required to power this component.

[CaptionsSettingsModal](./?path=/docs/components-captions-settings-modal--docs) is a modal pop up that allows users to select spoken/caption language. Developers and use 'usePropsFor' to gather all the information required to power this component.

[CaptionsBanner](./?path=/docs/components-captions-banner--docs) is a component that combines and displays captions and Real-Time Text in one banner. Developers and use 'usePropsFor' to gather all the information required to power this component, including the list of Real-Time Text and captions messages in the call. User can also use this component for captions only or Real-Time Text only.

## How to use Captions

Captions is automatically included within the CallComposite and CallWithChatComposite experiences. To turn on captions, users need to navigate to the control bar after call is connected, and click on more button. Inside the menu pop up, click on Turn on captions.

The spoken language is set to English by default. Your end user can use the UI to change the spoken language if a different language is being used in the meeting. This changes this spoken language for all users in the call.

The caption language (Teams Interop Closed Captions) is set to English by default. Change it by clicking on the Caption Settings button after captions has already started if user prefers the captions to be translated to a different language.

<Stack tokens={{ childrenGap: '3rem' }} style={overviewPageImagesStackStyle}>
  <Stack.Item align="center">
    <>Using the more menu to turn on captions</>
    <img
      style={{ width: '100%' }}
      src="images/StartCaptions.png"
      alt="example of component that can be used for starting captions"
    />
  </Stack.Item>
  <Stack.Item align="center">
    <>Captions Setting modal to change spoken language</>
    <img
      style={{ width: '100%' }}
      src="images/CaptionsSettings.png"
      alt="example of component that can be used for setting languages for captions"
    />
  </Stack.Item>
  <Stack.Item align="center">
    <>Captions Setting modal to change spoken language and caption language</>
    <img
      style={{ width: '100%' }}
      src="images/TeamsCaptionsSettings.png"
      alt="example of component that can be used for setting languages for teams captions"
    />
  </Stack.Item>
  <Stack.Item align="center">
    <>Captions started</>
    <img
      style={{ width: '100%' }}
      src="images/Captions.png"
      alt="example of component that can be used for displaying captions"
    />
  </Stack.Item>
  <PrimaryButton
    style={{ width: 'fit-content', color: 'white' }}
    text="Go to CallComposite to see captions in action"
    href="../?path=/story/composites-callcomposite-basic-example--basic-example"
  />
</Stack>

## Disable captions

The UI Library enables users to hide captions UI when they do not wish to use the captions service.

<Source code={exampleDisableCaptions} />

## Start Captions In The Background

The UI Library enables users to start captions in the background automatically when joining in the call if they do not wish to enable captions using the UI elements provided.

Use the example code below to start captions in the background without the captions UI showing up, and get the captions data through listening to captionsReceived event.

<Source code={exampleStartCaptionsBackgroundNoUI} />

Use the example code below to start captions in the background with the captions UI showing up automatically.

<Source code={exampleStartCaptionsBackgroundShowUI} />
