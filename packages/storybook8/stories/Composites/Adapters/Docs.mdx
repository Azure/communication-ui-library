import { Meta, Source } from '@storybook/addon-docs';
import { Note } from '../../utils/Note';

import CallAdapterExampleText from '!!raw-loader!./snippets/CallAdapterExample.snippet.tsx';
import CallAdapterStateChangesText from '!!raw-loader!./snippets/CallAdapterStateChanges.snippet.txt';
import ChatAdapterExampleText from '!!raw-loader!./snippets/ChatAdapterExample.snippet.tsx';
import ChatAdapterStateChangesText from '!!raw-loader!./snippets/ChatAdapterStateChanges.snippet.txt';

<Meta title="Composites/Adapters" />

# Adapters for Composites

Composites deliver turn-key communication experiences for developers.
They make it easy for developers to add end-to-end communication experiences to their apps with only a couple lines of code.
To power Composites, the UI library provides `Adapters`, one for each Composite. These adapters make use of the stateful clients for calling and chat in conjunction with React Hooks like usePropsFor to provide developers a single interface to configure Composites.

## Setting Up Adapters

To setup the adapters, you will need to provide the adapter with key metadata required.
This most importantly includes an access token for your Azure Communication Services resource and context information for the call or chat thread you want to join.
To create the adapters we will use the `useAzureCommunicationCallAdapter` and `useAzureCommunicationChatAdapter` hooks we provide from the UI library.
These hooks use their own internal logic using React hooks, to create an adapter for use with the composites.

One of the key functions of the `use...Adapter` hooks is to call `dispose()` on the adapter when it is no longer needed. The adapters implement the `Disposable` interface and this method needs to be called
to cleanup resources used by the adapter.

- When using the `useAzureCommunication...Adapter` hooks, clean up is automatic
- When using the `createAzureCommunication...Adapter` methods directly, you _must_ call `dispose()` on the adapter prior to setting it to `undefined`.

### Call Adapter

To initialize the call adapter, you will be required to provide a call locator with the information of the group or meeting you are trying to join.
Group Id for Azure Communication Services take the shape of GUID generated by the developer to identify a call inside their tenant.
Teams Meeting information can be acquired through [Microsoft Graph](https://docs.microsoft.com/graph/overview).

<Source code={CallAdapterExampleText} />

<Note>Note: The `displayName` in Call Composite can be a maximum of 256 characters.</Note>

### Chat Adapter

To initialize the chat adapter, you will be required to provide an endpoint url for the Azure Communication Services resource on [Azure Portal](https://portal.azure.com).
In addition, you will need to provide a thread Id. Thread Id is provisioned from the Azure Communication Services by creating a new thread or adding the user to an existing thread.
For more information on thread Id, see our [documentation](https://docs.microsoft.com/azure/communication-services/concepts/chat/concepts).

<Source code={ChatAdapterExampleText} />

<Note>Note: The `adapter` in Chat Composite is specifically designed for single-thread usage only.</Note>

## Using Adapters

Once initialized, adapters can be used to initialize Composites as well as to pragmatically take actions on the call or chat experience.

### Initializing Composites with Adapters

With the initialized adapters, we can now hook them into the calling and chat composites.

```typescript

import { CallComposite, ChatComposite} from '@azure/communication-react';

<CallComposite adapter={callAdapter} />

<ChatComposite adapter={chatAdapter} />

```

### Accessing Adapter Contents

The adapters provide developers access to state, actions and events related to the underlying chat and calling SDKs.
Below are some examples that might be helpful, but additional methods are available.

#### Call Adapter Examples

<Source code={CallAdapterStateChangesText} />

#### Chat Adapter Examples

<Source code={ChatAdapterStateChangesText} />

The ChatAdapter and the ChatComposite are purpose-built to support single chat thread. Only events, such as 'messagesReceived', from the thread that initialized the ChatAdapter, will be triggered. To accommodate multiple threads usage, you can leverage the foundational service assistant, the Chat [StatefulClient](./?path=/docs/stateful-client-overview--docs), in conjunction with [usePropsFor](./?path=/docs/stateful-client-react-hooks-usepropsfor--docs) to render the Chat UI Component for an enhanced chatting experience. Alternatively, you can manage multiple adapters corresponding to different threads, and display the Chat UI Composite based on the threads the user wishes to access.

## Interfaces

### CallAdapter

| **`Method`**                              | **`Details`**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| ----------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **`onStateChange`**                       | Subscribes the `handler` to `stateChanged` events.<br /><br />**Signature:**<br />`onStateChange`(`handler: (state: CallAdapterState) => void`): `void`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **`offStateChange`**                      | Unsubscribes the `handler` to `stateChanged` events.<br /><br />**Signature:**<br />`offStateChange`(`handler: (state: CallAdapterState) => void`): `void`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| **`getState`**                            | Get the current `State`.<br /><br />**Signature:**<br />`getState`(): `CallAdapterState`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| **`dispose`**                             | Dispose of the `Composite`.<br /><br />**Signature:**<br />`dispose`(): `void`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| **`holdCall`** **(Beta)**                 | Hold the call. `Microphone`, `camera`, and `audio` will be turned off.<br /><br />**Signature:**<br />`holdCall`(): `Promise<void>`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| **`joinCall`** **(Deprecated)**           | Join the call with `microphone` initially on/off.<br /><br />**Signature:**<br />`joinCall`(`microphoneOn?: boolean`): `Call` \| `undefined` <br /><br />`microphoneOn`: Join call with `microphone` initially enabled.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **`joinCall`**                            | Join the call with `microphone` or `camera` initially on/off.<br /><br />**Signature:**<br />`joinCall`(`options?: JoinCallOptions`): `Call` \| `undefined` <br /><br />`JoinCallOptions`: Options bag to set `camera`/`microphone` default state when joining call. `true`: on, `false`: off, `'keep'`: maintain precall state.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| **`leaveCall`**                           | Leave the call.<br /><br />**Signature:**<br />`leaveCall`(`forEveryone?: boolean`): `Promise<void>` <br /><br />`forEveryone`: Whether to remove all participants when leaving                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| **`resumeCall`** **(Beta)**               | Resume the call after being on hold.<br /><br />**Signature:**<br />`resumeCall`(): `Promise<void>`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| **`startCamera`**                         | Start the `camera`. This method will start rendering a local `camera` view when the call is not active.<br /><br />**Signature:**<br />`startCamera`(`options?: VideoStreamOptions`): `Promise<void>`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **`stopCamera`**                          | Stop the `camera`. This method will stop rendering a local `camera` view when the call is not active.<br /><br />**Signature:**<br />`stopCamera`(): `Promise<void>`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **`mute`**                                | Mute the current user during the call or disable `microphone` locally.<br /><br />**Signature:**<br />`mute`(): `Promise<void>`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| **`unmute`**                              | Unmute the current user during the call or enable `microphone` locally.<br /><br />**Signature:**<br />`unmute`(): `Promise<void>`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| **`startCall`** **(Beta)**                | Start the call.<br /><br />**Signature:**<br />`startCall`(`participants: string[]`): `Call` \| `undefined` <br /><br />`participants`: Array of `participantIds` to join                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| **`startScreenShare`**                    | Start sharing the `screen` during a call.<br /><br />**Signature:**<br />`startScreenShare`(): `Promise<void>`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| **`stopScreenShare`**                     | Stop sharing the `screen`.<br /><br />**Signature:**<br />`stopScreenShare`(): `Promise<void>`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| **`addParticipant`** **(Beta)**           | Add a `participant` to the call.<br /><br />**Signature:**<br />`addParticipant`(`participant: CommunicationIdentifier`, `options?: AddPhoneNumberOptions`): `Promise<void>`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| **`removeParticipant`**                   | Remove a `participant` from the call.<br /><br />**Signature:**<br />`removeParticipant`(`userId: string`): `Promise<void>` <br /><br />`userId`: Id of the `participant` to be removed                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **`createStreamView`**                    | Create the `html` view for a `stream`.<br /><br />**Signature:**<br />`createStreamView`(`remoteUserId?: string`, `options?: VideoStreamOptions`): `Promise<void>` <br /><br />`remoteUserId`: Id of the `participant` to render. Leave this `undefined` to create the local `camera` view. <br /><br />`options`: Options to control how `video` streams are rendered.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **`disposeStreamView`**                   | Dispose the `html` view for a `stream`.<br /><br />**Signature:**<br />`disposeStreamView`(`remoteUserId?: string`, `options?: VideoStreamOptions`): `Promise<void>` <br /><br />`remoteUserId`: Id of the `participant` to render. Leave this `undefined` to dispose the local `camera` view. <br /><br />`options`: Options to control how `video` streams are rendered.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| **`askDevicePermission`**                 | Ask for permissions of `devices`.<br /><br />**Signature:**<br />`askDevicePermission`(`constrain: PermissionConstraints`): `Promise<void>` <br /><br />`constrain`: What permissions are being asked for.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| **`queryCameras`**                        | Query for available `camera` devices.<br /><br />**Signature:**<br />`queryCameras`(): `Promise<VideoDeviceInfo[]>`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| **`queryMicrophones`**                    | Query for available `microphone` devices.<br /><br />**Signature:**<br />`queryMicrophones`(): `Promise<AudioDeviceInfo[]>`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| **`querySpeakers`**                       | Query for available `speaker` devices.<br /><br />**Signature:**<br />`querySpeakers`(): `Promise<AudioDeviceInfo[]>`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **`setCamera`**                           | Set the `camera` to use in the call.<br /><br />**Signature:**<br />`setCamera`(`sourceInfo: VideoDeviceInfo`, `options?: VideoStreamOptions`): `Promise<void>` <br /><br />`sourceInfo`: `Camera` device to choose, pick one returned by `queryCameras`. <br /><br />`options`: Options to control how the `camera` stream is rendered.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| **`setMicrophone`**                       | Set the `microphone` to use in the call.<br /><br />**Signature:**<br />`setMicrophone`(`sourceInfo: AudioDeviceInfo`): `Promise<void>` <br /><br />`sourceInfo`: `Microphone` device to choose, pick one returned by `queryMicrophones`.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| **`setSpeaker`**                          | Set the `speaker` to use in the call.<br /><br />**Signature:**<br />`setSpeaker`(`sourceInfo: AudioDeviceInfo`): `Promise<void>` <br /><br />`sourceInfo`: `Speaker` device to choose, pick one returned by `querySpeakers`.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| **`startCaptions`**                       | Start captions in `teams` interop call.<br /><br />**Signature:**<br />`startCaptions`(`options: StartCaptionsOptions`): `Promise<void>` <br /><br />`options`: Captions setting options for starting captions.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| **`stopCaptions`**                        | Stop captions in `teams` interop call.<br /><br />**Signature:**<br />`stopCaptions`(): `Promise<void>`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **`raiseHand`**                           | Publish raised hand state.<br /><br />**Signature:**<br />`raiseHand`(): `Promise<void>`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| **`lowerHand`**                           | Remove raised hand state.<br /><br />**Signature:**<br />`lowerHand`(): `Promise<void>`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **`setCaptionLanguage`**                  | Set caption language for captions in `teams` interop call.<br /><br />**Signature:**<br />`setCaptionLanguage`(`language: string`): `Promise<void>`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| **`setSpokenLanguage`**                   | Set spoken language for captions in `teams` interop call.<br /><br />**Signature:**<br />`setSpokenLanguage`(`language: string`): `Promise<void>`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| **`submitSurvey`**                        | Send the end-of-call survey result.<br /><br />**Signature:**<br />`submitSurvey`(`survey: CallSurvey`): `Promise<CallSurveyResponse` \| `undefined>`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **`startVideoBackgroundEffect`**          | Start the video background effect.<br /><br />**Signature:**<br />`startVideoBackgroundEffect`(`backgroundEffect: VideoBackgroundEffect`): `Promise<void>`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| **`stopVideoBackgroundEffects`**          | Stop the video background effect.<br /><br />**Signature:**<br />`stopVideoBackgroundEffects`(): `Promise<void>`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| **`updateBackgroundPickerImages`**        | Override the background picker images for background replacement effect.<br /><br />**Signature:**<br />`updateBackgroundPickerImages`(`backgroundImages: VideoBackgroundImage[]`): `void`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| **`updateSelectedVideoBackgroundEffect`** | Update the selected video background effect.<br /><br />**Signature:**<br />`updateSelectedVideoBackgroundEffect`(`selectedVideoBackground: VideoBackgroundEffect`): `void`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| **`startNoiseSuppressionEffect`**         | Start the noise suppression effect.<br /><br />**Signature:**<br />`startNoiseSuppressionEffect`(): `Promise<void>`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| **`stopNoiseSuppressionEffect`**          | Stop the noise suppression effect.<br /><br />**Signature:**<br />`stopNoiseSuppressionEffect`(): `Promise<void>`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| **`on`**                                  | Subscribe to `event`.<br /><br />Events:<br /> `participantsJoined` <br /> `participantsLeft` <br /> `isMutedChanged` <br /> `callIdChanged` <br /> `isLocalScreenSharingActiveChanged` <br /> `displayNameChanged` <br /> `isSpeakingChanged` <br /> `callEnded` <br /> `diagnosticChanged` <br /> `error` <br /> `captionsReceived` <br /> `isCaptionsActiveChanged` <br /> `transferAccepted` <br /> `capabilitiesChanged` <br /> `spotlightChanged` <br /> <br />**Signature:**<br /> `on`(`event: 'participantsJoined'`, `listener: ParticipantsJoinedListener`): `void` <br /> `on`(`event: 'participantsLeft'`, `listener: ParticipantsLeftListener`): `void` <br /> `on`(`event: 'isMutedChanged'`, `listener: IsMutedChangedListener`): `void` <br /> `on`(`event: 'callIdChanged'`, `listener: CallIdChangedListener`): `void` <br /> `on`(`event: 'isLocalScreenSharingActiveChanged'`, `listener: IsLocalScreenSharingActiveChangedListener`): `void` <br /> `on`(`event: 'displayNameChanged'`, `listener: DisplayNameChangedListener`): `void` <br /> `on`(`event: 'isSpeakingChanged'`, `listener: IsSpeakingChangedListener`): `void` <br /> `on`(`event: 'callEnded'`, `listener: CallEndedListener`): `void` <br /> `on`(`event: 'diagnosticChanged'`, `listener: DiagnosticChangedEventListner`): `void` <br /> `on`(`event: 'error'`, `listener: (e: AdapterError) => void`): `void` <br />`on`(`event: 'captionsReceived'`, `listener: CaptionsReceivedListener`): `void` <br /> `on`(`event: 'isCaptionsActiveChanged'`, `listener: IsCaptionsActiveChangedListener`): `void` <br /> `on`(`event: 'transferAccepted'`, `listener: TransferAcceptedListener`): `void` <br /> `on`(`event: 'capabilitiesChanged'`, `listener: CapabilitiesChangedListener`): `void` <br /> `on`(`event: 'spotlightChanged'`, `listener: SpotlightChangedListener`): `void`                   |
| **`off`**                                 | Unsubscribe from `event`.<br /><br />Events:<br /> `participantsJoined` <br /> `participantsLeft` <br /> `isMutedChanged` <br /> `callIdChanged` <br /> `isLocalScreenSharingActiveChanged` <br /> `displayNameChanged` <br /> `isSpeakingChanged` <br /> `callEnded` <br /> `diagnosticChanged` <br /> `error` <br /> `captionsReceived` <br /> `isCaptionsActiveChanged` <br /> `transferAccepted` <br /> `capabilitiesChanged` <br /> `spotlightChanged` <br /> <br />**Signature:**<br /> `off`(`event: 'participantsJoined'`, `listener: ParticipantsJoinedListener`): `void` <br /> `off`(`event: 'participantsLeft'`, `listener: ParticipantsLeftListener`): `void` <br /> `off`(`event: 'isMutedChanged'`, `listener: IsMutedChangedListener`): `void` <br /> `off`(`event: 'callIdChanged'`, `listener: CallIdChangedListener`): `void` <br /> `off`(`event: 'isLocalScreenSharingActiveChanged'`, `listener: IsLocalScreenSharingActiveChangedListener`): `void` <br /> `off`(`event: 'displayNameChanged'`, `listener: DisplayNameChangedListener`): `void` <br /> `off`(`event: 'isSpeakingChanged'`, `listener: IsSpeakingChangedListener`): `void` <br /> `off`(`event: 'callEnded'`, `listener: CallEndedListener`): `void` <br /> `off`(`event: 'diagnosticChanged'`, `listener: DiagnosticChangedEventListner`): `void` <br /> `off`(`event: 'error'`, `listener: (e: AdapterError) => void`): `void` <br />`off`(`event: 'captionsReceived'`, `listener: CaptionsReceivedListener`): `void` <br />`off`(`event: 'isCaptionsActiveChanged'`, `listener: IsCaptionsActiveChangedListener`): `void` <br /> `off`(`event: 'transferAccepted'`, `listener: TransferAcceptedListener`): `void` <br /> `off`(`event: 'capabilitiesChanged'`, `listener: CapabilitiesChangedListener`): `void` <br /> `off`(`event: 'spotlightChanged'`, `listener: SpotlightChangedListener`): `void` |

### CallAdapterState

| Property                              | Type                                                                                                                                                  |
| ------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------- |
| **`isLocalPreviewMicrophoneEnabled`** | `boolean`                                                                                                                                             |
| **`page`**                            | `"accessDeniedTeamsMeeting"` \| `"call"` \| `"configuration"` \| `"joinCallFailedDueToNoNetwork"` \| `"leftCall"` \| `"lobby"` \| `"removedFromCall"` |
| **`userId`**                          | `CommunicationIdentifierKind`                                                                                                                         |
| **`displayName`**                     | `string`                                                                                                                                              |
| **`alternateCallerId`** **(Beta)**    | `string`                                                                                                                                              |
| **`call`**                            | [`CallState`](https://docs.microsoft.com/en-us/javascript/api/@azure/communication-react/callstate)                                                   |
| **`devices`**                         | `DeviceManagerState`                                                                                                                                  |
| **`endedCall`**                       | `CallState`                                                                                                                                           |
| **`isTeamsCall`**                     | `boolean`                                                                                                                                             |
| **`latestErrors`**                    | `CallAdapterErrors` <br /><br />Latest error encountered for each operation performed via the adapter.                                                |
| **`hideAttendeeNames`**               | `boolean`                                                                                                                                             |

### ChatAdapter

| Method                         | Details                                                                                                           | Signature                                                                       |
| ------------------------------ | ----------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------- |
| **`fetchInitialData`**         | Fetch initial state for the Chat adapter. Performs the minimal fetch necessary for ChatComposite and API methods. | `() => Promise<void>`                                                           |
| **`onStateChange`**            | Subscribes the handler to stateChanged events.                                                                    | `(handler: (state: `[`ChatAdapterState`](#chatadapterstate)`) => void) => void` |
| **`offStateChange`**           | Unsubscribes the handler to stateChanged events.                                                                  | `(handler: (state: `[`ChatAdapterState`](#chatadapterstate)`) => void) => void` |
| **`getState`**                 | Get the current State                                                                                             | `() => `[`ChatAdapterState`](#chatadapterstate)                                 |
| **`dispose`**                  | Dispose of the Composite                                                                                          | `() => void`                                                                    |
| **`sendMessage`**              | Send a message in the thread.                                                                                     | `(content: string, options?: SendMessageOptions) : Promise<void>`               |
| **`sendReadReceipt`**          | Send a read receipt for a message.                                                                                | `(chatMessageId: string) => Promise<void>`                                      |
| **`sendTypingIndicator`**      | Send typing indicator in the thread.                                                                              | `() => Promise<void>`                                                           |
| **`removeParticipant`**        | Remove a participant in the thread.                                                                               | `(userId: string) => Promise<void>`                                             |
| **`setTopic`**                 | Set the topic for the thread.                                                                                     | `(topicName: string) => Promise<void>`                                          |
| **`updateMessage`**            | Update a message content.                                                                                         | `(messageId: string, content: string) => Promise<void>`                         |
| **`deleteMessage`**            | Delete a message in the thread.                                                                                   | `(messageId: string) => Promise<void>`                                          |
| **`loadPreviousChatMessages`** | Load more previous messages in the chat thread history.                                                           | `(messagesToLoad: number) => Promise<boolean>`                                  |
| **`downloadResourceToCache`**  | Downloads a resource into the cache for the given message.                                                        | `(resourceDetails: `[`ResourceDetails`](#resourcedetails)`): Promise<void>`     |
| **`removeResourceFromCache`**  | Removes a resource from the cache for the given message.                                                          | `(resourceDetails: `[`ResourceDetails`](#resourcedetails)`): Promise<void>`     |

### ChatAdapterState

| Property           | Type                                                                                                                                     |
| ------------------ | ---------------------------------------------------------------------------------------------------------------------------------------- |
| **`error`**        | `Error`                                                                                                                                  |
| **`userId`**       | [`CommunicationIdentifierKind`](https://docs.microsoft.com/en-us/javascript/api/@azure/communication-common/communicationidentifierkind) |
| **`displayName`**  | `string`                                                                                                                                 |
| **`thread`**       | [`ChatThreadClientState`](https://learn.microsoft.com/en-us/javascript/api/@azure/communication-react/chatthreadclientstate)             |
| **`latestErrors`** | `ChatAdapterErrors` <br /><br />Latest error encountered for each operation performed via the adapter                                    |

### ResourceDetails

| Property          | Type                                                                          |
| ----------------- | ----------------------------------------------------------------------------- |
| **`threadId`**    | `string` <br /><br />Thread Id for the resource.                              |
| **`messageId`**   | `string` <br /><br />Message Id for the message that the resource belongs to. |
| **`resourceUrl`** | `string` <br /><br />Download URL for the given resource.                     |

## Functions

### createAzureCommunicationCallAdapter

```ts
async function createAzureCommunicationCallAdapter(args: AzureCommunicationCallAdapterArgs);
```

#### AzureCommunicationCallAdapterArgs

| Property                           | Type                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| ---------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **`userId`**                       | [`CommunicationUserIdentifier`](https://docs.microsoft.com/en-us/javascript/api/@azure/communication-common/communicationuseridentifier)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **`displayName`**                  | `string` <br />_DisplayName has a limit of of 256 characters._                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| **`credential`**                   | [`CommunicationTokenCredential`](https://docs.microsoft.com/en-us/javascript/api/@azure/communication-common/azurecommunicationtokencredential)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| **`locator`**                      | [`GroupCallLocator`](https://docs.microsoft.com/en-us/javascript/api/azure-communication-services/@azure/communication-calling/groupcalllocator) \| [`TeamsMeetingLinkLocator`](https://docs.microsoft.com/en-us/javascript/api/azure-communication-services/@azure/communication-calling/teamsmeetinglinklocator) \| [`TeamsMeetingIdLocator`](https://docs.microsoft.com/en-us/javascript/api/azure-communication-services/@azure/communication-calling/teamsmeetingidlocator) \| [`RoomCallLocator`](https://docs.microsoft.com/en-us/javascript/api/azure-communication-services/@azure/communication-calling/roomcalllocator) **(Beta)** \| `CallParticipantsLocator` **(Beta)** <br /><br /> _CallParticipantsLocator is an array of participantIds to join._ |
| **`alternateCallerId`** **(Beta)** | `string`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |

### createTeamsCallAdapter **(Beta)**

```ts
async function createTeamsCallAdapter(args: TeamsCallAdapterArgs);
```

#### TeamsCallAdapterArgs (Beta)

| Property         | Type                                                                                                                                                                                                                                                                                                                                                    |
| ---------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **`userId`**     | [`MicrosoftTeamsUserIdentifier`](https://docs.microsoft.com/en-us/javascript/api/@azure/communication-common/MicrosoftTeamsUserIdentifier)                                                                                                                                                                                                              |
| **`credential`** | [`CommunicationTokenCredential`](https://docs.microsoft.com/en-us/javascript/api/@azure/communication-common/azurecommunicationtokencredential)                                                                                                                                                                                                         |
| **`locator`**    | [`TeamsMeetingLinkLocator`](https://docs.microsoft.com/en-us/javascript/api/azure-communication-services/@azure/communication-calling/TeamsMeetingLinkLocator) \| [`TeamsMeetingIdLocator`](https://docs.microsoft.com/en-us/javascript/api/azure-communication-services/@azure/communication-calling/TeamsMeetingIdLocator) \| CallParticipantsLocator |
| **`options`**    | TeamsAdapterOptions                                                                                                                                                                                                                                                                                                                                     |

### TeamsAdapterOptions (Beta)

| Property                     | Type                                                                                                                      |
| ---------------------------- | ------------------------------------------------------------------------------------------------------------------------- |
| **`videoBackgroundOptions`** | `{videoBackgroundImages?: VideoBackgroundImage[]; onResolveDependency?: () => Promise<VideoBackgroundEffectsDependency>}` |
| **`onFetchProfile`**         | `(userId: string, defaultProfile?: Profile) => Promise<Profile \| undefined>`                                             |

### createAzureCommunicationChatAdapter

```ts
async function createAzureCommunicationCallAdapter(args: AzureCommunicationChatAdapterArgs);
```

#### AzureCommunicationChatAdapterArgs

| Property          | Type                                                                                                                                            |
| ----------------- | ----------------------------------------------------------------------------------------------------------------------------------------------- |
| **`userId`**      | [`CommunicationUserIdentifier`](https://docs.microsoft.com/en-us/javascript/api/@azure/communication-common/communicationuseridentifier)        |
| **`displayName`** | `string` <br />_DisplayName has a limit of of 256 characters._                                                                                  |
| **`credential`**  | [`CommunicationTokenCredential`](https://docs.microsoft.com/en-us/javascript/api/@azure/communication-common/azurecommunicationtokencredential) |
| **`endpoint`**    | `string`                                                                                                                                        |
| **`threadId`**    | `string`                                                                                                                                        |

### createAzureCommunicationChatAdapterFromClient

```ts
async function createAzureCommunicationChatAdapterFromClient(
  chatClient: StatefulChatClient,
  chatThreadClient: ChatThreadClient
);
```

| Property               | Type                                                                                                                  |
| ---------------------- | --------------------------------------------------------------------------------------------------------------------- |
| **`chatClient`**       | [`StatefulChatClient`](https://docs.microsoft.com/en-us/javascript/api/@azure/communication-react/statefulchatclient) |
| **`chatThreadClient`** | [`ChatThreadClient`](https://docs.microsoft.com/en-us/javascript/api/@azure/communication-chat/chatthreadclient)      |
