import { Meta, Source } from '@storybook/addon-docs';
import { Note } from '../../utils/Note';
import './table.css';

import CallAdapterExampleText from '!!raw-loader!./snippets/CallAdapterExample.snippet.tsx';
import CallAdapterStateChangesText from '!!raw-loader!./snippets/CallAdapterStateChanges.snippet.txt';
import ChatAdapterExampleText from '!!raw-loader!./snippets/ChatAdapterExample.snippet.tsx';
import ChatAdapterStateChangesText from '!!raw-loader!./snippets/ChatAdapterStateChanges.snippet.txt';

<Meta title="Composites/Adapters" />

# Adapters for Composites

Composites deliver turn-key communication experiences for developers.
They make it easy for developers to add end-to-end communication experiences to their apps with only a couple lines of code.
To power Composites, the UI library provides `Adapters`, one for each Composite. These adapters make use of the stateful clients for calling and chat in conjunction with React Hooks like usePropsFor to provide developers a single interface to configure Composites.

## Setting Up Adapters

To setup the adapters, you will need to provide the adapter with key metadata required.
This most importantly includes an access token for your Azure Communication Services resource and context information for the call or chat thread you want to join.
To create the adapters we will use the `useAzureCommunicationCallAdapter` and `useAzureCommunicationChatAdapter` hooks we provide from the UI library.
These hooks use their own internal logic using React hooks, to create an adapter for use with the composites.

One of the key functions of the `use...Adapter` hooks is to call `dispose()` on the adapter when it is no longer needed. The adapters implement the `Disposable` interface and this method needs to be called
to cleanup resources used by the adapter.

- When using the `useAzureCommunication...Adapter` hooks, clean up is automatic
- When using the `createAzureCommunication...Adapter` methods directly, you _must_ call `dispose()` on the adapter prior to setting it to `undefined`.

### Call Adapter

To initialize the call adapter, you will be required to provide a call locator with the information of the group or meeting you are trying to join.
Group Id for Azure Communication Services take the shape of GUID generated by the developer to identify a call inside their tenant.
Teams Meeting information can be acquired through [Microsoft Graph](https://docs.microsoft.com/graph/overview).

<Source code={CallAdapterExampleText} />

<Note>Note: The `displayName` in Call Composite can be a maximum of 256 characters.</Note>

### Chat Adapter

To initialize the chat adapter, you will be required to provide an endpoint url for the Azure Communication Services resource on [Azure Portal](https://portal.azure.com).
In addition, you will need to provide a thread Id. Thread Id is provisioned from the Azure Communication Services by creating a new thread or adding the user to an existing thread.
For more information on thread Id, see our [documentation](https://docs.microsoft.com/azure/communication-services/concepts/chat/concepts).

<Source code={ChatAdapterExampleText} />

<Note>Note: The `adapter` in Chat Composite is specifically designed for single-thread usage only.</Note>

## Using Adapters

Once initialized, adapters can be used to initialize Composites as well as to pragmatically take actions on the call or chat experience.

### Initializing Composites with Adapters

With the initialized adapters, we can now hook them into the calling and chat composites.

```typescript

import { CallComposite, ChatComposite} from '@azure/communication-react';

<CallComposite adapter={callAdapter} />

<ChatComposite adapter={chatAdapter} />

```

### Accessing Adapter Contents

The adapters provide developers access to state, actions and events related to the underlying chat and calling SDKs.
Below are some examples that might be helpful, but additional methods are available.

#### Call Adapter Examples

<Source code={CallAdapterStateChangesText} />

#### Chat Adapter Examples

<Source code={ChatAdapterStateChangesText} />

The ChatAdapter and the ChatComposite are purpose-built to support single chat thread. Only events, such as 'messagesReceived', from the thread that initialized the ChatAdapter, will be triggered. To accommodate multiple threads usage, you can leverage the foundational service assistant, the Chat [StatefulClient](./?path=/docs/stateful-client-overview--docs), in conjunction with [usePropsFor](./?path=/docs/stateful-client-react-hooks-usepropsfor--docs) to render the Chat UI Component for an enhanced chatting experience. Alternatively, you can manage multiple adapters corresponding to different threads, and display the Chat UI Composite based on the threads the user wishes to access.

## Interfaces

### CallAdapter

| Method                                    | Details                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| ----------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **`onStateChange`**                       | Subscribes the handler to stateChanged events.<br /><br />**Signature:**<br />`(handler: (state: ` [`CallAdapterState`](#calladapterstate) `) => void) => void`                                                                                                                                                                                                                                                                                                                                                                                                                       |
| **`offStateChange`**                      | Unsubscribes the handler to stateChanged events.<br /><br />**Signature:**<br />`(handler: (state: ` [`CallAdapterState`](#calladapterstate) `) => void) => void`                                                                                                                                                                                                                                                                                                                                                                                                                     |
| **`getState`**                            | Get the current State.<br /><br />**Signature:**<br />`() => ` [`CallAdapterState`](#calladapterstate)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| **`dispose`**                             | Dispose of the Composite.<br /><br />**Signature:**<br />`() => void`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| **`holdCall`**                            | Hold the call. Microphone, camera, and audio will be turned off.<br /><br />**Signature:**<br />`() => Promise<void>`                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| **`joinCall`** **(Deprecated)**           | Join the call with microphone initially on/off.<br /><br />**Signature:**<br />`(microphoneOn?: boolean ) => Call`                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| **`joinCall`**                            | Join the call with microphone or camera initially on/off.<br /><br />**Signature:**<br />`(options?: JoinCallOptions) => Call`                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| **`leaveCall`**                           | Leave the call.<br /><br />`forEveryone`: Whether to remove all participants when leaving.<br /><br />**Signature:**<br />`(forEveryone?: boolean) => Promise<void>`                                                                                                                                                                                                                                                                                                                                                                                                                  |
| **`resumeCall`**                          | Resume the call after being on hold.<br /><br />**Signature:**<br />`() => Promise<void>`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **`startCamera`**                         | Start the camera. This method will start rendering a local camera view when the call is not active.<br /><br />`options`: Options to control how video streams are rendered.<br /><br />**Signature:**<br />`(options?: ` [`VideoStreamOptions`](https://docs.microsoft.com/en-us/javascript/api/@azure/communication-react/videostreamoptions) `) => Promise<void>`                                                                                                                                                                                                                  |
| **`stopCamera`**                          | Stop the camera. This method will stop rendering a local camera view when the call is not active.<br /><br />**Signature:**<br />`() => Promise<void>`                                                                                                                                                                                                                                                                                                                                                                                                                                |
| **`mute`**                                | Mute the current user during the call or disable the microphone locally.<br /><br />**Signature:**<br />`() => Promise<void>`                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| **`unmute`**                              | Unmute the current user during the call or enable the microphone locally.<br /><br />**Signature:**<br />`() => Promise<void>`                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| **`startCall`**                           | Start the call.<br /><br />`participants`: Array of participant IDs to join.<br /><br />**Signature:**<br />`(participants: string[]) => Call`                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| **`startScreenShare`**                    | Start sharing the screen during a call.<br /><br />**Signature:**<br />`() => Promise<void>`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **`stopScreenShare`**                     | Stop sharing the screen.<br /><br />**Signature:**<br />`() => Promise<void>`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| **`addParticipant`**                      | Add a participant to the call.<br /><br />`participant`: The participant to add.<br /><br />`options`: Options for adding a phone number.<br /><br />**Signature:**<br />`(participant: ` [`CommunicationIdentifier`](https://docs.microsoft.com/en-us/javascript/api/@azure/communication-common/communicationidentifier?view=azure-node-latest) `, options?: ` [`AddPhoneNumberOptions`](https://docs.microsoft.com/en-us/javascript/api/azure-communication-services/@azure/communication-calling/addphonenumberoptions?view=azure-communication-services-js) `) => Promise<void>` |
| **`removeParticipant`**                   | Remove a participant from the call.<br /><br />`userId`: ID of the participant to be removed.<br /><br />**Signature:**<br />`(userId: string) => Promise<void>`                                                                                                                                                                                                                                                                                                                                                                                                                      |
| **`createStreamView`**                    | Create the HTML view for a stream.<br /><br />`remoteUserId`: ID of the participant to render. Leave this `undefined` to create the local camera view.<br /><br />`options`: Options to control how video streams are rendered.<br /><br />**Signature:**<br />`(remoteUserId?: string, options?: ` [`VideoStreamOptions`](https://docs.microsoft.com/en-us/javascript/api/@azure/communication-react/videostreamoptions) `) => Promise<void>`                                                                                                                                        |
| **`disposeStreamView`**                   | Dispose the HTML view for a stream.<br /><br />`remoteUserId`: ID of the participant to render. Leave this `undefined` to dispose of the local camera view.<br /><br />`options`: Options to control how video streams are rendered.<br /><br />**Signature:**<br />`(remoteUserId?: string, options?: ` [`VideoStreamOptions`](https://docs.microsoft.com/en-us/javascript/api/@azure/communication-react/videostreamoptions) `) => Promise<void>`                                                                                                                                   |
| **`askDevicePermission`**                 | Ask for permissions of devices.<br /><br />`constrain`: Constrain what permissions are being asked for.<br /><br />**Signature:**<br />`(constrain: `[`PermissionConstraints`](https://docs.microsoft.com/en-us/javascript/api/azure-communication-services/@azure/communication-calling/permissionconstraints)`) => Promise<void>`                                                                                                                                                                                                                                                   |
| **`queryCameras`**                        | Query for available camera devices.<br /><br />**Signature:**<br />`() => Promise<`[`VideoDeviceInfo`](https://docs.microsoft.com/en-us/javascript/api/azure-communication-services/@azure/communication-calling/videodeviceinfo)`[]>`                                                                                                                                                                                                                                                                                                                                                |
| **`queryMicrophones`**                    | Query for available microphone devices.<br /><br />**Signature:**<br />`() => Promise<`[`AudioDeviceInfo`](https://docs.microsoft.com/en-us/javascript/api/azure-communication-services/@azure/communication-calling/audiodeviceinfo)`[]>`                                                                                                                                                                                                                                                                                                                                            |
| **`querySpeakers`**                       | Query for available speaker devices.<br /><br />**Signature:**<br />`() => Promise<`[`AudioDeviceInfo`](https://docs.microsoft.com/en-us/javascript/api/azure-communication-services/@azure/communication-calling/audiodeviceinfo)`[]>`                                                                                                                                                                                                                                                                                                                                               |
| **`setCamera`**                           | Set the camera to use in the call.<br /><br />`sourceInfo`: Camera device to choose, pick one returned by `queryCameras`.<br /><br />`options`: Options to control how the camera stream is rendered.<br /><br />**Signature:**<br />`(sourceInfo: `[`VideoDeviceInfo`](https://docs.microsoft.com/en-us/javascript/api/azure-communication-services/@azure/communication-calling/videodeviceinfo) `, options?: ` [`VideoStreamOptions`](https://docs.microsoft.com/en-us/javascript/api/@azure/communication-react/videostreamoptions)`) => Promise<void>`                           |
| **`setMicrophone`**                       | Set the microphone to use in the call.<br /><br />`sourceInfo`: Microphone device to choose, pick one returned by `queryMicrophones`.<br /><br />**Signature:**<br />`(sourceInfo: `[`AudioDeviceInfo`](https://docs.microsoft.com/en-us/javascript/api/azure-communication-services/@azure/communication-calling/audiodeviceinfo)`) => Promise<void>`                                                                                                                                                                                                                                |
| **`setSpeaker`**                          | Set the speaker to use in the call.<br /><br />`sourceInfo`: Speaker device to choose, pick one returned by `querySpeakers`.<br /><br />**Signature:**<br />`(sourceInfo: `[`AudioDeviceInfo`](https://docs.microsoft.com/en-us/javascript/api/azure-communication-services/@azure/communication-calling/audiodeviceinfo)`) => Promise<void>`                                                                                                                                                                                                                                         |
| **`startCaptions`**                       | Start captions in Teams interop call.<br /><br />`options`: Captions setting options for starting captions.<br /><br />**Signature:**<br />`(options: `[`StartCaptionsOptions`](https://docs.microsoft.com/en-us/javascript/api/azure-communication-services/@azure/communication-calling/startcaptionsoptions)`) => Promise<void>`                                                                                                                                                                                                                                                   |
| **`stopCaptions`**                        | Stop captions in Teams interop call.<br /><br />**Signature:**<br />`() => Promise<void>`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **`raiseHand`**                           | Publish raised hand state.<br /><br />**Signature:**<br />`() => Promise<void>`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| **`lowerHand`**                           | Remove raised hand state.<br /><br />**Signature:**<br />`() => Promise<void>`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| **`setCaptionLanguage`**                  | Set caption language for captions in Teams interop call.<br /><br />`language`: Language code for the captions.<br /><br />**Signature:**<br />`(language: string) => Promise<void>`                                                                                                                                                                                                                                                                                                                                                                                                  |
| **`setSpokenLanguage`**                   | Set spoken language for captions in Teams interop call.<br /><br />`language`: Language code for the spoken language.<br /><br />**Signature:**<br />`(language: string) => Promise<void>`                                                                                                                                                                                                                                                                                                                                                                                            |
| **`submitSurvey`**                        | Send the end of call survey result.<br /><br />`survey`: The survey data to submit.<br /><br />**Signature:**<br />`(survey: CallSurvey) => Promise<CallSurveyResponse ` \| ` undefined>`                                                                                                                                                                                                                                                                                                                                                                                             |
| **`startVideoBackgroundEffect`**          | Start the video background effect.<br /><br />`backgroundEffect`: The video background effect to start.<br /><br />**Signature:**<br />`(backgroundEffect: VideoBackgroundEffect) => Promise<void>`                                                                                                                                                                                                                                                                                                                                                                                   |
| **`stopVideoBackgroundEffects`**          | Stop the video background effect.<br /><br />**Signature:**<br />`() => Promise<void>`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| **`updateBackgroundPickerImages`**        | Override the background picker images for background replacement effect.<br /><br />`backgroundImages`: Array of background images to update.<br /><br />**Signature:**<br />`(backgroundImages: VideoBackgroundImage[]) => void`                                                                                                                                                                                                                                                                                                                                                     |
| **`updateSelectedVideoBackgroundEffect`** | Update the selected video background effect.<br /><br />`selectedVideoBackground`: The video background effect to update.<br /><br />**Signature:**<br />`(selectedVideoBackground: VideoBackgroundEffect) => void`                                                                                                                                                                                                                                                                                                                                                                   |
| **`startNoiseSuppressionEffect`**         | Start the noise suppression effect.<br /><br />**Signature:**<br />`() => Promise<void>`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| **`stopNoiseSuppressionEffect`**          | Stop the noise suppression effect.<br /><br />**Signature:**<br />`() => Promise<void>`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| **`on`**                                  | Subscribe to event.<br /><br />Events:<br /> `participantsJoined` <br /> `participantsLeft` <br /> `isMutedChanged` <br /> `callIdChanged` <br /> `isLocalScreenSharingActiveChanged` <br /> `displayNameChanged` <br /> `isSpeakingChanged` <br /> `callEnded` <br /> `diagnosticChanged` <br /> `error` <br /> `captionsReceived` <br /> `isCaptionsActiveChanged` <br /> `transferAccepted` <br /> `capabilitiesChanged` <br /> `spotlightChanged` <br /><br />**Signature:**<br />`on(event: string, listener: Function): void`                                                   |
| **`off`**                                 | Unsubscribe from event.<br /><br />Events:<br /> `participantsJoined` <br /> `participantsLeft` <br /> `isMutedChanged` <br /> `callIdChanged` <br /> `isLocalScreenSharingActiveChanged` <br /> `displayNameChanged` <br /> `isSpeakingChanged` <br /> `callEnded` <br /> `diagnosticChanged` <br /> `error` <br /> `captionsReceived` <br /> `isCaptionsActiveChanged` <br /> `transferAccepted` <br /> `capabilitiesChanged` <br /> `spotlightChanged` <br /><br />**Signature:**<br />`off(event: string, listener: Function): void`                                              |

### CallAdapterState

| Property                              | Type                                                                                                                                                  |
| ------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------- |
| **`isLocalPreviewMicrophoneEnabled`** | `boolean`                                                                                                                                             |
| **`page`**                            | `"accessDeniedTeamsMeeting"` \| `"call"` \| `"configuration"` \| `"joinCallFailedDueToNoNetwork"` \| `"leftCall"` \| `"lobby"` \| `"removedFromCall"` |
| **`userId`**                          | `CommunicationIdentifierKind`                                                                                                                         |
| **`displayName`**                     | `string`                                                                                                                                              |
| **`alternateCallerId`**               | `string`                                                                                                                                              |
| **`call`**                            | [`CallState`](https://docs.microsoft.com/en-us/javascript/api/@azure/communication-react/callstate)                                                   |
| **`devices`**                         | `DeviceManagerState`                                                                                                                                  |
| **`endedCall`**                       | `CallState`                                                                                                                                           |
| **`isTeamsCall`**                     | `boolean`                                                                                                                                             |
| **`latestErrors`**                    | `CallAdapterErrors` <br /><br />Latest error encountered for each operation performed via the adapter.                                                |
| **`hideAttendeeNames`**               | `boolean`                                                                                                                                             |

### ChatAdapter

| Method                         | Details                                                                                                           | Signature                                                                       |
| ------------------------------ | ----------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------- |
| **`fetchInitialData`**         | Fetch initial state for the Chat adapter. Performs the minimal fetch necessary for ChatComposite and API methods. | `() => Promise<void>`                                                           |
| **`onStateChange`**            | Subscribes the handler to stateChanged events.                                                                    | `(handler: (state: `[`ChatAdapterState`](#chatadapterstate)`) => void) => void` |
| **`offStateChange`**           | Unsubscribes the handler to stateChanged events.                                                                  | `(handler: (state: `[`ChatAdapterState`](#chatadapterstate)`) => void) => void` |
| **`getState`**                 | Get the current State                                                                                             | `() => `[`ChatAdapterState`](#chatadapterstate)                                 |
| **`dispose`**                  | Dispose of the Composite                                                                                          | `() => void`                                                                    |
| **`sendMessage`**              | Send a message in the thread.                                                                                     | `(content: string, options?: SendMessageOptions) : Promise<void>`               |
| **`sendReadReceipt`**          | Send a read receipt for a message.                                                                                | `(chatMessageId: string) => Promise<void>`                                      |
| **`sendTypingIndicator`**      | Send typing indicator in the thread.                                                                              | `() => Promise<void>`                                                           |
| **`removeParticipant`**        | Remove a participant in the thread.                                                                               | `(userId: string) => Promise<void>`                                             |
| **`setTopic`**                 | Set the topic for the thread.                                                                                     | `(topicName: string) => Promise<void>`                                          |
| **`updateMessage`**            | Update a message content.                                                                                         | `(messageId: string, content: string) => Promise<void>`                         |
| **`deleteMessage`**            | Delete a message in the thread.                                                                                   | `(messageId: string) => Promise<void>`                                          |
| **`loadPreviousChatMessages`** | Load more previous messages in the chat thread history.                                                           | `(messagesToLoad: number) => Promise<boolean>`                                  |
| **`downloadResourceToCache`**  | Downloads a resource into the cache for the given message.                                                        | `(resourceDetails: `[`ResourceDetails`](#resourcedetails)`): Promise<void>`     |
| **`removeResourceFromCache`**  | Removes a resource from the cache for the given message.                                                          | `(resourceDetails: `[`ResourceDetails`](#resourcedetails)`): Promise<void>`     |

### ChatAdapterState

| Property           | Type                                                                                                                                     |
| ------------------ | ---------------------------------------------------------------------------------------------------------------------------------------- |
| **`error`**        | `Error`                                                                                                                                  |
| **`userId`**       | [`CommunicationIdentifierKind`](https://docs.microsoft.com/en-us/javascript/api/@azure/communication-common/communicationidentifierkind) |
| **`displayName`**  | `string`                                                                                                                                 |
| **`thread`**       | [`ChatThreadClientState`](https://learn.microsoft.com/en-us/javascript/api/@azure/communication-react/chatthreadclientstate)             |
| **`latestErrors`** | `ChatAdapterErrors` <br /><br />Latest error encountered for each operation performed via the adapter                                    |

### ResourceDetails

| Property          | Type                                                                          |
| ----------------- | ----------------------------------------------------------------------------- |
| **`threadId`**    | `string` <br /><br />Thread Id for the resource.                              |
| **`messageId`**   | `string` <br /><br />Message Id for the message that the resource belongs to. |
| **`resourceUrl`** | `string` <br /><br />Download URL for the given resource.                     |

## Functions

### createAzureCommunicationCallAdapter

```ts
async function createAzureCommunicationCallAdapter(
  args: AzureCommunicationCallAdapterArgs | AzureCommunicationOutboundCallAdapterArgs
);
```

#### AzureCommunicationCallAdapterArgs

| Property          | Type                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| ----------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **`userId`**      | [`CommunicationUserIdentifier`](https://docs.microsoft.com/en-us/javascript/api/@azure/communication-common/communicationuseridentifier)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **`displayName`** | `string` <br />_DisplayName has a limit of of 256 characters._                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| **`credential`**  | [`CommunicationTokenCredential`](https://docs.microsoft.com/en-us/javascript/api/@azure/communication-common/azurecommunicationtokencredential)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| **`locator`**     | [`GroupCallLocator`](https://docs.microsoft.com/en-us/javascript/api/azure-communication-services/@azure/communication-calling/groupcalllocator) \| [`TeamsMeetingLinkLocator`](https://docs.microsoft.com/en-us/javascript/api/azure-communication-services/@azure/communication-calling/teamsmeetinglinklocator) \| [`TeamsMeetingIdLocator`](https://docs.microsoft.com/en-us/javascript/api/azure-communication-services/@azure/communication-calling/teamsmeetingidlocator) \| [`RoomCallLocator`](https://docs.microsoft.com/en-us/javascript/api/azure-communication-services/@azure/communication-calling/roomcalllocator) \| `CallParticipantsLocator` **(Beta)** <br /><br /> _CallParticipantsLocator is an array of participantIds to join. This locator will always be in **beta**._ |
| **`options`**     | `AzureCommunicationCallAdapterOptions`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |

#### AzureCommunicationOutboundCallAdapterArgs

| Property            | Type                                                                                                                                            |
| ------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------- |
| **`userId`**        | [`CommunicationUserIdentifier`](https://docs.microsoft.com/en-us/javascript/api/@azure/communication-common/communicationuseridentifier)        |
| **`displayName`**   | `string` <br />_DisplayName has a limit of of 256 characters._                                                                                  |
| **`credential`**    | [`CommunicationTokenCredential`](https://docs.microsoft.com/en-us/javascript/api/@azure/communication-common/azurecommunicationtokencredential) |
| **`TargetCallees`** | `StartCallIdentifier[]` <br /> Array of identifiers representing the participants you will make a call to.                                      |
| **`options`**       | `AzureCommunicationCallAdapterOptions`                                                                                                          |

### createTeamsCallAdapter

```ts
async function createTeamsCallAdapter(args: TeamsCallAdapterArgs | TeamsOutboundCallAdapterArgs);
```

#### TeamsCallAdapterArgs

| Property         | Type                                                                                                                                                                                                                                                                                                                                                               |
| ---------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **`userId`**     | [`MicrosoftTeamsUserIdentifier`](https://docs.microsoft.com/en-us/javascript/api/@azure/communication-common/MicrosoftTeamsUserIdentifier)                                                                                                                                                                                                                         |
| **`credential`** | [`CommunicationTokenCredential`](https://docs.microsoft.com/en-us/javascript/api/@azure/communication-common/azurecommunicationtokencredential)                                                                                                                                                                                                                    |
| **`locator`**    | [`TeamsMeetingLinkLocator`](https://docs.microsoft.com/en-us/javascript/api/azure-communication-services/@azure/communication-calling/TeamsMeetingLinkLocator) \| [`TeamsMeetingIdLocator`](https://docs.microsoft.com/en-us/javascript/api/azure-communication-services/@azure/communication-calling/TeamsMeetingIdLocator) \| **beta** `CallParticipantsLocator` |
| **`options`**    | `TeamsAdapterOptions`                                                                                                                                                                                                                                                                                                                                              |

#### TeamsOutboundCallAdapterArgs

| Property            | Type                                                                                                                                            |
| ------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------- |
| **`userId`**        | [`MicrosoftTeamsUserIdentifier`](https://docs.microsoft.com/en-us/javascript/api/@azure/communication-common/MicrosoftTeamsUserIdentifier)      |
| **`credential`**    | [`CommunicationTokenCredential`](https://docs.microsoft.com/en-us/javascript/api/@azure/communication-common/azurecommunicationtokencredential) |
| **`targetCallees`** | `StartTeamsCallIdentifier[]` <br /> Array of identifiers representing the participants you will make a call to.                                 |
| **`options`**       | `TeamsAdapterOptions`                                                                                                                           |

### TeamsAdapterOptions

| Property                     | Type                                                                                                                      |
| ---------------------------- | ------------------------------------------------------------------------------------------------------------------------- |
| **`videoBackgroundOptions`** | `{videoBackgroundImages?: VideoBackgroundImage[]; onResolveDependency?: () => Promise<VideoBackgroundEffectsDependency>}` |
| **`onFetchProfile`**         | `(userId: string, defaultProfile?: Profile) => Promise<Profile \| undefined>`                                             |

### createAzureCommunicationChatAdapter

```ts
async function createAzureCommunicationCallAdapter(args: AzureCommunicationChatAdapterArgs);
```

#### AzureCommunicationChatAdapterArgs

| Property          | Type                                                                                                                                            |
| ----------------- | ----------------------------------------------------------------------------------------------------------------------------------------------- |
| **`userId`**      | [`CommunicationUserIdentifier`](https://docs.microsoft.com/en-us/javascript/api/@azure/communication-common/communicationuseridentifier)        |
| **`displayName`** | `string` <br />_DisplayName has a limit of of 256 characters._                                                                                  |
| **`credential`**  | [`CommunicationTokenCredential`](https://docs.microsoft.com/en-us/javascript/api/@azure/communication-common/azurecommunicationtokencredential) |
| **`endpoint`**    | `string`                                                                                                                                        |
| **`threadId`**    | `string`                                                                                                                                        |

### createAzureCommunicationChatAdapterFromClient

```ts
async function createAzureCommunicationChatAdapterFromClient(
  chatClient: StatefulChatClient,
  chatThreadClient: ChatThreadClient
);
```

| Property               | Type                                                                                                                  |
| ---------------------- | --------------------------------------------------------------------------------------------------------------------- |
| **`chatClient`**       | [`StatefulChatClient`](https://docs.microsoft.com/en-us/javascript/api/@azure/communication-react/statefulchatclient) |
| **`chatThreadClient`** | [`ChatThreadClient`](https://docs.microsoft.com/en-us/javascript/api/@azure/communication-chat/chatthreadclient)      |
