<!DOCTYPE html>
<head>
  <meta charset="utf-8" />
  <title>Basic example for CallComposite and ChatComposite</title>
</head>
<body>
  <!-- height need to be set for composite to fit the layout -->
  <div id="video-call" style="height: 500px;"></div>
  <div id="chat" style="height: 500px;"></div>
  <script src="./dist/chatComposite.js"></script>
  <script src="./dist/callComposite.js"></script>
  <script src="./dist/service.js"></script>
  <script type="module">
    const { user, token } = await service.createUserWithToken();
    const displayName = 'Bob';

    const callAdapter = await callComposite.loadCallComposite({
      containerId: 'video-call',
      groupId: '6e606975-7004-4c03-be37-e0851ed1850b', // any GUID
      displayName: displayName,
      userId: user,
      token: token
    });

    const threadId = await service.createChatThread();
    await service.addChatUser(threadId, user, displayName);
    const endpointUrl = await service.getEndpointUrl();

    const chatAdapter = await chatComposite.loadChatComposite({
      containerId: 'chat',
      displayName: displayName,
      threadId: threadId,
      endpointUrl: endpointUrl,
      userId: user,
      token: token
    });

    await chatAdapter.sendMessage('Hello to you! ðŸ‘‹');

    window.onbeforeunload = () => {
      callAdapter.dispose();
      chatAdapter.dispose();
    };
  </script>
</body>
