<!-- Copyright (c) Microsoft Corporation. -->
<!-- Licensed under the MIT License. -->

<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="Azure Communication Services - UI Library: Calling Sample app" />
    <title>UI Library Calling Sample</title>

    <!-- Used for debugging only -->
    <script type="text/javascript">
      const urlParams = new URLSearchParams(window.location.search);
      const isEnabled = urlParams.get('rrt');
      if (isEnabled !== 'true') {
        return;
      }

      const script = document.createElement('script');
      script.src = 'https://cdn.jsdelivr.net/npm/react-render-tracker';
      document.head.appendChild(script);
    </script>
    <style>
      body { display: flex; flex-direction: column; height: 100vh; }
      #Root { flex: 1; }
    </style>
  </head>

  <body>
    <div id="signout-container"></div>
    <div id="root" class="Root"></div>
    <script type="text/javascript">
      window.FabricConfig = {};
    </script>
    <script>
      // Only displayed if Authentication is setup in App service
      fetch('signout.html').then(response => response.text())
        .then(data => {
          document.getElementById('signout-container').innerHTML = data;
          function handleSignOut() {
            console.log("You have signed out!");
            window.location.href = 'https://login.microsoftonline.com/common/oauth2/v2.0/logout';
          }
          var display = document.cookie.split(';').some(item => item.trim().startsWith('AppServiceAuthSession='))
            ? 'flex' : 'none';
          document.getElementById('signout-bar').style.display = display;

          document.getElementById('signoutButton').addEventListener('click', handleSignOut);
        });
    </script>
  </body>
</html>
